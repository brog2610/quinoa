<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Quinoa: tk::UnsMeshMap Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Documents</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classtk_1_1_uns_mesh_map.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">tk::UnsMeshMap Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="tk::UnsMeshMap" -->
<p>Charm++ array map for initial placement of array elements using an unstructured grid.  
 <a href="classtk_1_1_uns_mesh_map.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_uns_mesh_map_8h_source.html">UnsMeshMap.h</a>&gt;</code></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_uns_mesh_map.html#a7fad17f47caf8b5acc08d60b5bc5e1cc">UnsMeshMap</a> (std::size_t npoin, const std::vector&lt; std::vector&lt; std::size_t &gt; &gt; &amp;point)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a7fad17f47caf8b5acc08d60b5bc5e1cc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_uns_mesh_map.html#aecd041427428ff7aa0b05598c08be79f">procNum</a> (int, const CkArrayIndex &amp;idx) override</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the home processor number for the array element based on unstructured-mesh-aware distribution computed in the constructor.  <a href="#aecd041427428ff7aa0b05598c08be79f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_uns_mesh_map.html#a9cf7151bf771bb49d264b11eff2b0118">populateInitial</a> (int, CkArrayIndex &amp;idx, void *msg, CkArrMgr *mgr) override</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create initial set of array elements based on the unstructured-mesh-aware distribution computed in the constructor.  <a href="#a9cf7151bf771bb49d264b11eff2b0118"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_uns_mesh_map.html#ab1470c9531e460df85ad4c30a21b13e3">fixPEs</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that all PEs create at least a single array element, fix if not.  <a href="#ab1470c9531e460df85ad4c30a21b13e3"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a">m_pe</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">PE assigned to each array element.  <a href="#a8a6830e6ffa73bd8f1b6f1759501bd4a"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Charm++ array map for initial placement of array elements using an unstructured grid. </p>
<p>The map object is used by the Charm++ array manager to determine the "home" PE of each element. The home PE is the PE upon which the array element is initially placed, which will retain responsibility for maintaining the location of the element. </p>

<p>Definition at line <a class="el" href="_uns_mesh_map_8h_source.html#l00066">66</a> of file <a class="el" href="_uns_mesh_map_8h_source.html">UnsMeshMap.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7fad17f47caf8b5acc08d60b5bc5e1cc"></a><!-- doxytag: member="tk::UnsMeshMap::UnsMeshMap" ref="a7fad17f47caf8b5acc08d60b5bc5e1cc" args="(std::size_t npoin, const std::vector&lt; std::vector&lt; std::size_t &gt; &gt; &amp;point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1_uns_mesh_map.html#a7fad17f47caf8b5acc08d60b5bc5e1cc">UnsMeshMap::UnsMeshMap</a> </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>npoin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">npoin</td><td>Total number of points in mesh </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">point</td><td>Global mesh point ids owned by each array element </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_uns_mesh_map_8_c_source.html#l00060">60</a> of file <a class="el" href="_uns_mesh_map_8_c_source.html">UnsMeshMap.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_uns_mesh_map_8_c_source.html#l00106">fixPEs()</a>, and <a class="el" href="_uns_mesh_map_8h_source.html#l00084">m_pe</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( npoin &gt; 0, <span class="stringliteral">&quot;Need at least a single mesh point&quot;</span> );
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( point.size() &gt;= CkNumPes(),
          <span class="stringliteral">&quot;UnsMeshMap only works with nchare &gt;= numPEs&quot;</span> );

  <span class="comment">// Vector of maps to associate the number of mesh points an array element</span>
  <span class="comment">// contributes to a pe to the array element</span>
  std::vector&lt; std::map&lt; std::size_t, std::size_t &gt; &gt; owner( point.size() );

  <span class="comment">// Compute number of mesh points per PE (chunksize)</span>
  <span class="keyword">const</span> <span class="keyword">auto</span> numpes = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( CkNumPes() );
  <span class="keyword">const</span> <span class="keyword">auto</span> chunksize = npoin&gt;numpes ? npoin/numpes : 1;

  <span class="comment">// Count up number of mesh points contributing to a PE for each array element</span>
  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;point.size(); ++e)    <span class="comment">// for all array elements</span>
    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : point[e]) {           <span class="comment">// for all points array element e owns</span>
      <span class="keyword">auto</span> pe = p / chunksize;          <span class="comment">// PE array element e contributes to</span>
      <span class="keywordflow">if</span> (pe == CkNumPes()) --pe;
      ++owner[e][pe];  <span class="comment">// count up number of points element e contributing to pe</span>
    }

  <span class="comment">// Find and store the PE with the largest number of points owned by an array</span>
  <span class="comment">// element. This is the key (PE) of the largest mapped_type of the element&#39;s</span>
  <span class="comment">// map, owner[e].</span>
  <span class="keyword">using</span> pr = decltype(owner)::value_type::value_type;
  <a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>.resize( owner.size() );
  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;owner.size(); ++e) {
    <span class="keyword">const</span> <span class="keyword">auto</span> most = std::max_element( begin(owner[e]), end(owner[e]),
                                        []( <span class="keyword">const</span> pr&amp; p1, <span class="keyword">const</span> pr&amp; p2 )
                                          { <span class="keywordflow">return</span> p1.second &lt; p2.second; } );
    <a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>[e] = most-&gt;first;
  }

  <span class="comment">// Check if all PEs have at least one array element to create, fix if not</span>
  <a class="code" href="classtk_1_1_uns_mesh_map.html#ab1470c9531e460df85ad4c30a21b13e3" title="Check that all PEs create at least a single array element, fix if not.">fixPEs</a>();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_uns_mesh_map_a7fad17f47caf8b5acc08d60b5bc5e1cc_cgraph.svg" width="446" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab1470c9531e460df85ad4c30a21b13e3"></a><!-- doxytag: member="tk::UnsMeshMap::fixPEs" ref="ab1470c9531e460df85ad4c30a21b13e3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_uns_mesh_map.html#ab1470c9531e460df85ad4c30a21b13e3">UnsMeshMap::fixPEs</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check that all PEs create at least a single array element, fix if not. </p>
<p>This is required because if the array elements, placed using this map object, send messages to some Charm++ chare group branches and the group happens to use Charm++'s structured dagger, such as <a class="el" href="classtk_1_1_lin_sys_merger.html">LinSysMerger</a>, memory problems will occur. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_uns_mesh_map_8_c_source.html#l00106">106</a> of file <a class="el" href="_uns_mesh_map_8_c_source.html">UnsMeshMap.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, and <a class="el" href="_uns_mesh_map_8h_source.html#l00084">m_pe</a>.</p>

<p>Referenced by <a class="el" href="_uns_mesh_map_8_c_source.html#l00060">UnsMeshMap()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// Build unique set of PEs the array elements are assigned to</span>
  std::set&lt; std::size_t &gt; nkind;
  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : <a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>) nkind.insert( p );

<span class="comment">//   std::cout &lt;&lt; CkMyPe() &lt;&lt; &quot;: &quot;;</span>
<span class="comment">//   for (auto p : m_pe) std::cout &lt;&lt; p &lt;&lt; &quot; &quot;;</span>
<span class="comment">//   std::cout &lt;&lt; std::endl;</span>

  <span class="comment">// If not all PEs have at least one array element to create, go through all</span>
  <span class="comment">// PEs that have no array elements assigned, and construct a map that</span>
  <span class="comment">// associates the number of PEs to array elements. Then as a replacement PE,</span>
  <span class="comment">// pick the PE that has the most array elements assigned. Then assign the</span>
  <span class="comment">// first of the elements assigned to the PE with the most work to the</span>
  <span class="comment">// replacement PE.</span>
  <span class="keywordflow">if</span> (nkind.size() != CkNumPes())
    <span class="keywordflow">for</span> (std::size_t p=0; p&lt;CkNumPes(); ++p)
      <span class="keywordflow">if</span> (!nkind.count(p)) {    <span class="comment">// if PE p has no array elements to create</span>
        <span class="comment">// Count up number elements for each PE</span>
        std::map&lt; std::size_t, std::size_t &gt; npe;
        <span class="keyword">using</span> pr = decltype(npe)::value_type;
        <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : m_pe) ++npe[q];
        <span class="comment">// Find the PE with the most array elements assigned</span>
        <span class="keyword">const</span> <span class="keyword">auto</span> most = std::max_element( begin(npe), end(npe),
                                            []( <span class="keyword">const</span> pr&amp; p1, <span class="keyword">const</span> pr&amp; p2 )
                                            { <span class="keywordflow">return</span> p1.second &lt; p2.second; } );
        <span class="keywordflow">for</span> (std::size_t q=0; q&lt;m_pe.size(); ++q)
          <span class="keywordflow">if</span> (m_pe[q] == most-&gt;first) { <span class="comment">// first element of the most loaded PE</span>
            <span class="comment">//std::cout &lt;&lt; CkMyPe() &lt;&lt; &quot;: replace &quot; &lt;&lt; m_pe[q] &lt;&lt; &quot; by &quot; &lt;&lt; p</span>
            <span class="comment">//          &lt;&lt; &quot; for e &quot; &lt;&lt; q &lt;&lt; std::endl;</span>
            m_pe[q] = p;        <span class="comment">// replace PE of m_pe[q] of element q by p</span>
            q = m_pe.size();    <span class="comment">// quit (enough to replace one)</span>
          }
      }

  nkind.clear();
  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : m_pe) nkind.insert( p );
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( nkind.size() == CkNumPes(),
          <span class="stringliteral">&quot;There are still PE(s) with no array elements assigned&quot;</span> );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9cf7151bf771bb49d264b11eff2b0118"></a><!-- doxytag: member="tk::UnsMeshMap::populateInitial" ref="a9cf7151bf771bb49d264b11eff2b0118" args="(int, CkArrayIndex &amp;idx, void *msg, CkArrMgr *mgr) override" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_uns_mesh_map.html#a9cf7151bf771bb49d264b11eff2b0118">UnsMeshMap::populateInitial</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CkArrayIndex &amp;&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CkArrMgr *&#160;</td>
          <td class="paramname"><em>mgr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [override]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create initial set of array elements based on the unstructured-mesh-aware distribution computed in the constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Charm++ array index object containing the number of initial array elements to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Charm++ messsage to use for array element creation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mgr</td><td>Array manager to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_uns_mesh_map_8_c_source.html#l00183">183</a> of file <a class="el" href="_uns_mesh_map_8_c_source.html">UnsMeshMap.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, and <a class="el" href="_uns_mesh_map_8h_source.html#l00084">m_pe</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> nelem = *idx.data();      <span class="comment">// number of array elements requested</span>
  <span class="keywordflow">if</span> (nelem == 0) <span class="keywordflow">return</span>;       <span class="comment">// no initial elements requested</span>

  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( nelem &lt;= <a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>.size(), <span class="stringliteral">&quot;Number of initial array elements larger than &quot;</span>
          <span class="stringliteral">&quot;the UnsMeshMap object holds PEs for&quot;</span> );

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e=0; e&lt;nelem; ++e)
    <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>[ static_cast&lt;std::size_t&gt;(e) ] == CkMyPe())
      mgr-&gt;insertInitial( e, CkCopyMsg(&amp;msg) );

  mgr-&gt;doneInserting();
  CkFreeMsg( msg );
}
</pre></div>
</div>
</div>
<a class="anchor" id="aecd041427428ff7aa0b05598c08be79f"></a><!-- doxytag: member="tk::UnsMeshMap::procNum" ref="aecd041427428ff7aa0b05598c08be79f" args="(int, const CkArrayIndex &amp;idx) override" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtk_1_1_uns_mesh_map.html#aecd041427428ff7aa0b05598c08be79f">UnsMeshMap::procNum</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CkArrayIndex &amp;&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [override]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the home processor number for the array element based on unstructured-mesh-aware distribution computed in the constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>Charm++ array index object containing the array element index to assign a PE to </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>PE assigned </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_uns_mesh_map_8_c_source.html#l00157">157</a> of file <a class="el" href="_uns_mesh_map_8_c_source.html">UnsMeshMap.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, and <a class="el" href="_uns_mesh_map_8h_source.html#l00084">m_pe</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// array element we assign PE for</span>
  <span class="keyword">auto</span> elem = <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(*idx.data());

  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( elem &lt; <a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>.size(),
          <span class="stringliteral">&quot;Array index larger than the number of chares for which the &quot;</span>
          <span class="stringliteral">&quot;UnsMeshMap object holds indices for&quot;</span> );

  <span class="keyword">auto</span> pe = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( <a class="code" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a" title="PE assigned to each array element.">m_pe</a>[ elem ] );

  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( pe &lt; CkNumPes(), <span class="stringliteral">&quot;Assigned PE (&quot;</span> + std::to_string(pe) +
          <span class="stringliteral">&quot;) larger than NumPEs (&quot;</span> + std::to_string(CkNumPes()) + <span class="stringliteral">&quot;)&quot;</span> );

  <span class="keywordflow">return</span> pe;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a8a6830e6ffa73bd8f1b6f1759501bd4a"></a><!-- doxytag: member="tk::UnsMeshMap::m_pe" ref="a8a6830e6ffa73bd8f1b6f1759501bd4a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt; <a class="el" href="classtk_1_1_uns_mesh_map.html#a8a6830e6ffa73bd8f1b6f1759501bd4a">tk::UnsMeshMap::m_pe</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>PE assigned to each array element. </p>

<p>Definition at line <a class="el" href="_uns_mesh_map_8h_source.html#l00084">84</a> of file <a class="el" href="_uns_mesh_map_8h_source.html">UnsMeshMap.h</a>.</p>

<p>Referenced by <a class="el" href="_uns_mesh_map_8_c_source.html#l00106">fixPEs()</a>, <a class="el" href="_uns_mesh_map_8_c_source.html#l00183">populateInitial()</a>, <a class="el" href="_uns_mesh_map_8_c_source.html#l00157">procNum()</a>, and <a class="el" href="_uns_mesh_map_8_c_source.html#l00060">UnsMeshMap()</a>.</p>

</div>
</div>

<p><a href="classtk_1_1_uns_mesh_map-members.html">List of all members.</a></p>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/jbakosi/quinoa/src/LoadBalance/<a class="el" href="_uns_mesh_map_8h_source.html">UnsMeshMap.h</a></li>
<li>/home/travis/build/jbakosi/quinoa/src/LoadBalance/<a class="el" href="_uns_mesh_map_8_c_source.html">UnsMeshMap.C</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespacetk.html">tk</a>      </li>
      <li class="navelem"><a class="el" href="classtk_1_1_uns_mesh_map.html">UnsMeshMap</a>      </li>

    <li class="footer">Generated on Mon Jul 6 2015 20:53:15 for Quinoa by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
