<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Quinoa: /home/jbakosi/code/quinoa/src/LinSys/LinSysMerger.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Documents</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_lin_sys_merger_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LinSysMerger.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_lin_sys_merger_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//******************************************************************************</span><span class="comment"></span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  \file      src/LinSys/LinSysMerger.h</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  \author    J. Bakosi</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  \date      Thu 18 Jun 2015 11:33:19 AM MDT</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  \copyright 2012-2015, Jozsef Bakosi.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  \brief     Linear system merger</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  \details   Linear system merger.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef LinSysMerger_h</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define LinSysMerger_h</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;iosfwd&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#if defined(__clang__) || defined(__GNUC__)</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic ignored &quot;-Wconversion&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;linsysmerger.decl.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#if defined(__clang__) || defined(__GNUC__)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;Types.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_timer_8h.html">Timer.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_exception_8h.html">Exception.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_container_util_8h.html">ContainerUtil.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hypre_matrix_8h.html">HypreMatrix.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hypre_vector_8h.html">HypreVector.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hypre_solver_8h.html">HypreSolver.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_performer_8h.html">Performer.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacetk.html">tk</a> {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//! Linear system merger Charm++ chare group class</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//! \details Instantiations of LinSysMerger comprise a processor aware Charm++</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//!   chare group. When instantiated, a new object is created on each PE and not</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//!   more (as opposed to individual chares or chare array object elements). The</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//!   group&#39;s elements are used to collect information from all chare objects</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//!   that happen to be on a given PE. See also the Charm++ interface file</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//!   linsysmerger.ci. The class is templated on the host as well as the work</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//!   proxy so that the same code (parameterized by the template arguments) can</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//!   be generated for interacting with different types of Charm++ proxies.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//! \see http://charm.cs.illinois.edu/manuals/html/charm++/manual.html</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//! \author J. Bakosi</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span><span class="keyword">template</span>&lt; <span class="keyword">class</span> HostProxy, <span class="keyword">class</span> WorkerProxy  &gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html">   54</a></span>&#160;<span class="keyword">class </span><a class="code" href="classtk_1_1_lin_sys_merger.html">LinSysMerger</a> : <span class="keyword">public</span> CBase_LinSysMerger&lt; HostProxy, WorkerProxy &gt; {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// Include Charm++ SDAG code. See http://charm.cs.illinois.edu/manuals/html/</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">// charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  LinSysMerger_SDAG_CODE</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a227e7127f4075b65f312b405e2584737">   61</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a227e7127f4075b65f312b405e2584737">Group</a> = CBase_LinSysMerger&lt; HostProxy, WorkerProxy &gt;;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">    //! Constructor</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    //! \param[in] host Charm++ host proxy</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    //! \param[in] npoin Total number of mesh points</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#adf7f86528567c210aa2228782d802e8e">   67</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1_lin_sys_merger.html#adf7f86528567c210aa2228782d802e8e">LinSysMerger</a>( HostProxy&amp; host, std::size_t npoin ) :</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a72df0d200bd61c88eec0fd2fe00698ce">m_host</a>( host ),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">m_chunksize</a>( npoin / static_cast&lt;<a class="code" href="namespacestd.html">std</a>::size_t&gt;(CkNumPes()) ),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a>( static_cast&lt;<a class="code" href="namespacestd.html">std</a>::size_t&gt;(CkMyPe()) * <a class="code" href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">m_chunksize</a> ),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a> + <a class="code" href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">m_chunksize</a> ),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a0113d46a268b90832e1d1332bb521bf2">m_nchare</a>( 0 ),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">m_nperow</a>( 0 ),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a9024bf48f49f5d13f793dea946355c26">m_matownpts</a>( 0 ),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a470a2431bee63cbf0d6a3ca9689c454d">m_matcompts</a>( 0 ),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a89a96108ea63db7b4330374af392acbb">m_vecownpts</a>( 0 ),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a33f86776a739083eacfd9a118f84740c">m_veccompts</a>( 0 )</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keyword">auto</span> remainder = npoin % <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(CkNumPes());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">if</span> (remainder &amp;&amp; CkMyPe() == CkNumPes()-1) <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a> += remainder;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">//std::cout &lt;&lt; CkMyPe() &lt;&lt; &quot;: [&quot; &lt;&lt; m_lower &lt;&lt; &quot;...&quot; &lt;&lt; m_upper &lt;&lt; &quot;)\n&quot;;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">// Create distributed linear system</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#ad9f98cef0219ba6d601076c13fe1308f">create</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">// Activate SDAG waits</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      wait4sol();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      wait4lhs();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      wait4rhs();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      wait4hypresol();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      wait4hyprelhs();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      wait4hyprerhs();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      wait4fillsol();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      wait4filllhs();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      wait4fillrhs();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      wait4asm();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      wait4stat();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">    //! \brief Create linear system, i.e., left-hand side matrix, vector of</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">    //!   unknowns, right-hand side vector, solver perform their initialization</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ad9f98cef0219ba6d601076c13fe1308f">  100</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ad9f98cef0219ba6d601076c13fe1308f">create</a>() {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">// Create my PE&#39;s lhs matrix distributed across all PEs</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a67367a8cc6e70c81f42b8601a8359bd2">m_A</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html#a51a6fa96ea67c8cd696b97ed9a2a06a7">create</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a>, <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a> );</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="comment">// Create my PE&#39;s rhs and unknown vectors distributed across all PEs</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a5fe4b99df3ff55d783d4965b29186d96">m_b</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac60c4df056ed06e98447bd2264576c5f">create</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a>, <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a> );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a6500e7136397e4486379afe48a4e23d3">m_x</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac60c4df056ed06e98447bd2264576c5f">create</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a>, <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a> );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">// Create linear solver</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a23769b496dbe36fb763a0c17fbbe85c4">m_solver</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_solver.html#a5e3ef63b60590577a079082d5a1f028f">create</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a65998173fb9f503a5d6fafef49dfea24">m_timestamp</a>.emplace_back( <span class="stringliteral">&quot;Create distributed linear system&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    //! Chares register on my PE</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aa509f2f499e9a43563d4f13684292337">  115</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#aa509f2f499e9a43563d4f13684292337">checkin</a>() { ++<a class="code" href="classtk_1_1_lin_sys_merger.html#a0113d46a268b90832e1d1332bb521bf2">m_nchare</a>; }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">    //! Chares contribute their global row ids</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    //! \param[in] worker Worker proxy contribution coming from</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    //! \param[in] fromch Charm chare array index contribution coming from</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    //! \param[in] row Global mesh point (row) indices contributed</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a960eb6ab61761ff9c8b4cd956bca4806">  123</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a960eb6ab61761ff9c8b4cd956bca4806">charerow</a>( WorkerProxy&amp; worker,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                   <span class="keywordtype">int</span> fromch,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                   <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; row )</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// Store worker proxy</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a721f4b7e69eeb0027ac4f981f7e2a193">m_worker</a> = worker;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="comment">// Collect ids of workers on my PE</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#acb58face0945dd27bd92fbf715c5e288">m_myworker</a>.push_back( fromch );</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">// Store rows owned and pack those to be exported, also build import map</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// used to test for completion</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      std::map&lt; std::size_t, std::set&lt; std::size_t &gt; &gt; exp;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> gid : row) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (gid &gt;= <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a> &amp;&amp; gid &lt; <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>) {  <span class="comment">// if own</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">m_rowimport</a>[ fromch ].push_back( gid );</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#af30bc56154a6833a3c13e95430467f06">m_row</a>.insert( gid );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          exp[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>(gid) ].insert( gid );</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// Export non-owned parts to fellow branches that own them</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">m_nperow</a> += exp.size();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        Group::thisProxy[ tope ].addrow( fromch, CkMyPe(), p.second );</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a991f044291b07e774e42fb247e77ce8c">rowcomplete</a>()) <a class="code" href="classtk_1_1_lin_sys_merger.html#a8779518d1ed304624a4ad9baee602642">signal2host_row_complete</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#a72df0d200bd61c88eec0fd2fe00698ce">m_host</a> );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">    //! Receive global row ids from fellow group branches</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">    //! \param[in] fromch Chare id contrubition coming from</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">    //! \param[in] frompe PE contrubition coming from</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">    //! \param[in] row Global mesh point (row) indices received</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a32b1d1936142b1418fe701b9256c8d7c">  154</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a32b1d1936142b1418fe701b9256c8d7c">addrow</a>( <span class="keywordtype">int</span> fromch, <span class="keywordtype">int</span> frompe, <span class="keyword">const</span> std::set&lt; std::size_t &gt;&amp; row ) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : row) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">m_rowimport</a>[ fromch ].push_back( r );</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#af30bc56154a6833a3c13e95430467f06">m_row</a>.insert( r );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      Group::thisProxy[ frompe ].recrow();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">    //! Acknowledge received row ids</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a11c7492ec2d3c9451cc4503f9ccad72a">  162</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a11c7492ec2d3c9451cc4503f9ccad72a">recrow</a>() {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      --<a class="code" href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">m_nperow</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a991f044291b07e774e42fb247e77ce8c">rowcomplete</a>()) <a class="code" href="classtk_1_1_lin_sys_merger.html#a8779518d1ed304624a4ad9baee602642">signal2host_row_complete</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#a72df0d200bd61c88eec0fd2fe00698ce">m_host</a> );</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    };</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">    //! Chares contribute their solution nonzero values</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">    //! \param[in] fromch Charm chare array index contribution coming from</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">    //! \param[in] sol Portion of the unknown/solution vector contributed,</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">    //!   containing global row indices and values</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a4648517e73f2f267abb8fb9f31fc3c7b">  173</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a4648517e73f2f267abb8fb9f31fc3c7b">charesol</a>( <span class="keywordtype">int</span> fromch, <span class="keyword">const</span> std::map&lt; std::size_t, tk::real &gt;&amp; <a class="code" href="classtk_1_1_lin_sys_merger.html#aa453f098efb706af61dcfa8720882df4">sol</a> ) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a397ad43640680dd0d61fc093599ce1df">m_timer</a>[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5a46ba9eba2f4b52116787dfa6fb4278e3">TimerTag::SOL</a> ]; <span class="comment">// start measuring merging of rhs</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">// Store solution vector nonzero values owned and pack those to be</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">// exported, also build import map used to test for completion</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      std::map&lt; std::size_t, std::map&lt; std::size_t, tk::real &gt; &gt; exp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : sol) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keyword">auto</span> gid = r.first;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (gid &gt;= <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a> &amp;&amp; gid &lt; <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>) {  <span class="comment">// if own</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#ab194ea640949641ee24cbb83b28425bc">m_solimport</a>[ fromch ].push_back( gid );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#ace0efc6863397e91df1fa9cfb3899686">m_sol</a>[gid] = r.second;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          exp[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>(gid) ][ gid ] = r.second;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        Group::thisProxy[ tope ].addsol( fromch, p.second );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a21d19431edcbfc9923e4e256de1ddd2c">solcomplete</a>()) trigger_sol_complete();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">    //! Receive solution vector nonzeros from fellow group branches</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    //! \param[in] fromch Chare id contrubition coming from</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">    //! \param[in] sol Portion of the unknown/solution vector contributed,</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">    //!   containing global row indices and values</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a05f9d2460aa9d93e9f7bec8927b4e815">  198</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a05f9d2460aa9d93e9f7bec8927b4e815">addsol</a>( <span class="keywordtype">int</span> fromch, <span class="keyword">const</span> std::map&lt; std::size_t, tk::real &gt;&amp; <a class="code" href="classtk_1_1_lin_sys_merger.html#aa453f098efb706af61dcfa8720882df4">sol</a> ) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : sol) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#ab194ea640949641ee24cbb83b28425bc">m_solimport</a>[ fromch ].push_back( r.first );</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#ace0efc6863397e91df1fa9cfb3899686">m_sol</a>[ r.first ] = r.second;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a21d19431edcbfc9923e4e256de1ddd2c">solcomplete</a>()) trigger_sol_complete();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">    //! Chares contribute their matrix nonzero values</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">    //! \param[in] fromch Charm chare array index contribution coming from</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">    //! \param[in] lhs Portion of the left-hand side matrix contributed,</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">    //!   containing global row and column indices and non-zero values</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a46d77ef343eda99009bb11f25e100860">  212</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a46d77ef343eda99009bb11f25e100860">charelhs</a>( <span class="keywordtype">int</span> fromch,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                   <span class="keyword">const</span> std::map&lt; std::size_t,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                   std::map&lt; std::size_t, tk::real &gt; &gt;&amp; <a class="code" href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">lhs</a> )</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a397ad43640680dd0d61fc093599ce1df">m_timer</a>[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5a8cbc0fb889c6cc21e0be26227a2b468b">TimerTag::LHS</a> ]; <span class="comment">// start measuring merging of lhs</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">// Store matrix nonzero values owned and pack those to be exported, also</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">// build import map used to test for completion</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      std::map&lt; std::size_t,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                std::map&lt; std::size_t,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                          std::map&lt; std::size_t, tk::real &gt; &gt; &gt; exp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : <a class="code" href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">lhs</a>) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keyword">auto</span> rowsize = r.second.size() * <span class="keyword">sizeof</span>( decltype(exp)::value_type );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">auto</span> gid = r.first;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">if</span> (gid &gt;= <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a> &amp;&amp; gid &lt; <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>) {  <span class="comment">// if own</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#a231c27b322a336a6fb430287fd265eb7">m_lhsimport</a>[ fromch ].push_back( gid );</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          <span class="keyword">auto</span>&amp; row = <a class="code" href="classtk_1_1_lin_sys_merger.html#a415897ff76dd044688f209aa647c9aaf">m_lhs</a>[gid];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : r.second) row[ c.first ] += c.second;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#a9024bf48f49f5d13f793dea946355c26">m_matownpts</a> += rowsize;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          exp[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>(gid) ][ gid ] = r.second;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#a470a2431bee63cbf0d6a3ca9689c454d">m_matcompts</a> += rowsize;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">// Export non-owned matrix rows values to fellow branches that own them</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        Group::thisProxy[ tope ].addlhs( fromch, p.second );</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#ad4042cd264f54934d02d3aef355e2376">lhscomplete</a>()) trigger_lhs_complete();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    //! Receive matrix nonzeros from fellow group branches</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    //! \param[in] fromch Chare id contrubition coming from</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">    //! \param[in] lhs Portion of the left-hand side matrix contributed,</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">    //!   containing global row and column indices and non-zero values</span></div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a1645eb91aea46b08342c9bcdd661e740">  246</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a1645eb91aea46b08342c9bcdd661e740">addlhs</a>( <span class="keywordtype">int</span> fromch,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                 <span class="keyword">const</span> std::map&lt; std::size_t,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                 std::map&lt; std::size_t, tk::real &gt; &gt;&amp; <a class="code" href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">lhs</a> ) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : <a class="code" href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">lhs</a>) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#a231c27b322a336a6fb430287fd265eb7">m_lhsimport</a>[ fromch ].push_back( r.first );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">auto</span>&amp; row = <a class="code" href="classtk_1_1_lin_sys_merger.html#a415897ff76dd044688f209aa647c9aaf">m_lhs</a>[ r.first ];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : r.second) row[ c.first ] += c.second;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#ad4042cd264f54934d02d3aef355e2376">lhscomplete</a>()) trigger_lhs_complete();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    //! Chares contribute their rhs nonzero values</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    //! \param[in] fromch Charm chare array index contribution coming from</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">    //! \param[in] rhs Portion of the right-hand side vector contributed,</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">    //!   containing global row indices and values</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a1b7805fe7ecbc7e003556252130b30ae">  263</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a1b7805fe7ecbc7e003556252130b30ae">charerhs</a>( <span class="keywordtype">int</span> fromch, <span class="keyword">const</span> std::map&lt; std::size_t, tk::real &gt;&amp; <a class="code" href="classtk_1_1_lin_sys_merger.html#a75f822ec1e0abfa71dadb9e3e6fe03ee">rhs</a> ) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a397ad43640680dd0d61fc093599ce1df">m_timer</a>[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5ae80302656805aeec44dc5d789d653c6b">TimerTag::RHS</a> ]; <span class="comment">// start measuring merging of rhs</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// Store vector nonzero values owned and pack those to be exported</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      std::map&lt; std::size_t, std::map&lt; std::size_t, tk::real &gt; &gt; exp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : rhs) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keyword">auto</span> gid = r.first;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (gid &gt;= <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a> &amp;&amp; gid &lt; <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>) {  <span class="comment">// if own</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#aa351412964251e1670fd19d08433b44e">m_rhsimport</a>[ fromch ].push_back( gid );</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <a class="code" href="classtk_1_1_lin_sys_merger.html#af26f3da27e4f2a636bd171c06e460def">m_rhs</a>[gid] += r.second;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          ++<a class="code" href="classtk_1_1_lin_sys_merger.html#a89a96108ea63db7b4330374af392acbb">m_vecownpts</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          exp[ <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>(gid) ][ gid ] = r.second;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          ++<a class="code" href="classtk_1_1_lin_sys_merger.html#a33f86776a739083eacfd9a118f84740c">m_veccompts</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        Group::thisProxy[ tope ].addrhs( fromch, p.second );</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a6d035d4a0720e49dcbbeda0c3d649f5f">rhscomplete</a>()) trigger_rhs_complete();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">    //! Receive right-hand side vector nonzeros from fellow group branches</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">    //! \param[in] fromch Chare id contrubition coming from</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">    //! \param[in] rhs Portion of the right-hand side vector contributed,</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    //!   containing global row indices and values</span></div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a269877a4716257ebe616d5579cbe43e2">  289</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a269877a4716257ebe616d5579cbe43e2">addrhs</a>( <span class="keywordtype">int</span> fromch, <span class="keyword">const</span> std::map&lt; std::size_t, tk::real &gt;&amp; <a class="code" href="classtk_1_1_lin_sys_merger.html#a75f822ec1e0abfa71dadb9e3e6fe03ee">rhs</a> ) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : rhs) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#aa351412964251e1670fd19d08433b44e">m_rhsimport</a>[ fromch ].push_back( r.first );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="classtk_1_1_lin_sys_merger.html#af26f3da27e4f2a636bd171c06e460def">m_rhs</a>[ r.first ] += r.second;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a6d035d4a0720e49dcbbeda0c3d649f5f">rhscomplete</a>()) trigger_rhs_complete();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    //! Assert that all global row indices have been received on my PE</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    //! \details The assert consists of three necessary conditions, which</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    //!   together comprise the sufficient condition that all global row indices</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    //!   have been received owned by this PE.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a6a2342bf25787ba16667e0f58fe35872">  301</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a6a2342bf25787ba16667e0f58fe35872">rowsreceived</a>() {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <span class="comment">// 1. have heard from every chare on my PE</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;              <a class="code" href="classtk_1_1_lin_sys_merger.html#acb58face0945dd27bd92fbf715c5e288">m_myworker</a>.size() == <a class="code" href="classtk_1_1_lin_sys_merger.html#a0113d46a268b90832e1d1332bb521bf2">m_nchare</a> &amp;&amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              <span class="comment">// 2. number of rows equals that of the expected on my PE</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              <a class="code" href="classtk_1_1_lin_sys_merger.html#af30bc56154a6833a3c13e95430467f06">m_row</a>.size() == <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>-<a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a> &amp;&amp;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;              <span class="comment">// 3. all fellow PEs have received my row ids contribution</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;              <a class="code" href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">m_nperow</a> == 0,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              <span class="comment">// if any of the above is not satisfied, the row ids are</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              <span class="comment">// incomplete</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;              <span class="stringliteral">&quot;Row ids are incomplete on PE &quot;</span> + std::to_string( CkMyPe() ) );</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// now that the global row ids are complete, build Hypre data from it</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#a6bd3aff0ef10419fd577251a113fe42e">hyprerow</a>();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a72df0d200bd61c88eec0fd2fe00698ce">  316</a></span>&#160;    HostProxy <a class="code" href="classtk_1_1_lin_sys_merger.html#a72df0d200bd61c88eec0fd2fe00698ce">m_host</a>;           <span class="comment">//!&lt; Host proxy</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a721f4b7e69eeb0027ac4f981f7e2a193">  317</a></span>&#160;<span class="comment"></span>    WorkerProxy <a class="code" href="classtk_1_1_lin_sys_merger.html#a721f4b7e69eeb0027ac4f981f7e2a193">m_worker</a>;       <span class="comment">//!&lt; Worker proxy</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">  318</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">m_chunksize</a>;    <span class="comment">//!&lt; Number of rows the first npe-1 PE own</span></div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">  319</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">m_lower</a>;        <span class="comment">//!&lt; Lower index of the global rows on my PE</span></div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">  320</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">m_upper</a>;        <span class="comment">//!&lt; Upper index of the global rows on my PE</span></div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a0113d46a268b90832e1d1332bb521bf2">  321</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a0113d46a268b90832e1d1332bb521bf2">m_nchare</a>;       <span class="comment">//!&lt; Number of chares contributing to my PE</span></div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">  322</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">m_nperow</a>;       <span class="comment">//!&lt; Number of fellow PEs to send row ids to</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span><span class="comment">    //! Ids of workers on my PE</span></div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#acb58face0945dd27bd92fbf715c5e288">  324</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#acb58face0945dd27bd92fbf715c5e288">m_myworker</a>;<span class="comment"></span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">    //!   id during the communication of the global row ids</span></div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">  327</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">m_rowimport</a>;<span class="comment"></span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    //!   id during the communication of the solution/unknown vector</span></div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ab194ea640949641ee24cbb83b28425bc">  330</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#ab194ea640949641ee24cbb83b28425bc">m_solimport</a>;<span class="comment"></span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    //!   id during the communication of the left-hand side matrix</span></div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a231c27b322a336a6fb430287fd265eb7">  333</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a231c27b322a336a6fb430287fd265eb7">m_lhsimport</a>;<span class="comment"></span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">    //!   id during the communication of the righ-hand side vector</span></div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aa351412964251e1670fd19d08433b44e">  336</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#aa351412964251e1670fd19d08433b44e">m_rhsimport</a>;<span class="comment"></span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">    //! Part of global row indices owned by my PE</span></div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#af30bc56154a6833a3c13e95430467f06">  338</a></span>&#160;<span class="comment"></span>    std::set&lt; std::size_t &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#af30bc56154a6833a3c13e95430467f06">m_row</a>;<span class="comment"></span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">    //! \brief Part of unknown/solution vector owned by my PE: global mesh point</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">    //!   row ids and values</span></div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ace0efc6863397e91df1fa9cfb3899686">  341</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, tk::real &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#ace0efc6863397e91df1fa9cfb3899686">m_sol</a>;<span class="comment"></span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">    //! \brief Part of left-hand side matrix owned by my PE: global mesh point</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">    //!   row and column ids, and nonzero value</span></div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a415897ff76dd044688f209aa647c9aaf">  344</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::map&lt; std::size_t, tk::real &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a415897ff76dd044688f209aa647c9aaf">m_lhs</a>;<span class="comment"></span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">    //! \brief Part of right-hand side vector owned by my PE: global mesh point</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">    //!   row ids and values</span></div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#af26f3da27e4f2a636bd171c06e460def">  347</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, tk::real &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#af26f3da27e4f2a636bd171c06e460def">m_rhs</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a6500e7136397e4486379afe48a4e23d3">  348</a></span>&#160;    <a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a> <a class="code" href="classtk_1_1_lin_sys_merger.html#a6500e7136397e4486379afe48a4e23d3">m_x</a>; <span class="comment">//!&lt; Hypre vector to store the solution/unknowns</span></div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a67367a8cc6e70c81f42b8601a8359bd2">  349</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html">tk::hypre::HypreMatrix</a> <a class="code" href="classtk_1_1_lin_sys_merger.html#a67367a8cc6e70c81f42b8601a8359bd2">m_A</a>; <span class="comment">//!&lt; Hypre matrix to store the left-hand side</span></div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a5fe4b99df3ff55d783d4965b29186d96">  350</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a> <a class="code" href="classtk_1_1_lin_sys_merger.html#a5fe4b99df3ff55d783d4965b29186d96">m_b</a>; <span class="comment">//!&lt; Hypre vector to store the right-hand side</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span><span class="comment">    //! Hypre solver</span></div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a23769b496dbe36fb763a0c17fbbe85c4">  352</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1hypre_1_1_hypre_solver.html">tk::hypre::HypreSolver</a> <a class="code" href="classtk_1_1_lin_sys_merger.html#a23769b496dbe36fb763a0c17fbbe85c4">m_solver</a>;<span class="comment"></span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">    //! Row indices for my PE</span></div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aefba1ac88619564e84c39b7664a2b146">  354</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#aefba1ac88619564e84c39b7664a2b146">m_hypreRows</a>;<span class="comment"></span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">    //! Number of matrix columns/rows on my PE</span></div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aefd53b197c19f8a801c36dc2aae61583">  356</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#aefd53b197c19f8a801c36dc2aae61583">m_hypreNcols</a>;<span class="comment"></span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">    //! Matrix column indices for rows on my PE</span></div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a97fb6e9331b0ff278a070fb4abe328e0">  358</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a97fb6e9331b0ff278a070fb4abe328e0">m_hypreCols</a>;<span class="comment"></span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">    //! Matrix nonzero values for my PE</span></div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a0b910dcaf03dbcdadf9187b9b1514941">  360</a></span>&#160;<span class="comment"></span>    std::vector&lt; tk::real &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a0b910dcaf03dbcdadf9187b9b1514941">m_hypreMat</a>;<span class="comment"></span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">    //! RHS vector nonzero values for my PE</span></div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aeee2a3d196324a906267b0ebd12a2654">  362</a></span>&#160;<span class="comment"></span>    std::vector&lt; tk::real &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#aeee2a3d196324a906267b0ebd12a2654">m_hypreRhs</a>;<span class="comment"></span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    //! Sol vector nonzero values for my PE</span></div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a859798eec68b98a1de58a120cf7aa641">  364</a></span>&#160;<span class="comment"></span>    std::vector&lt; tk::real &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a859798eec68b98a1de58a120cf7aa641">m_hypreSol</a>;<span class="comment"></span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">    //! Global-&gt;local row id map for sending back solution vector parts</span></div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a48ae968e35e3bd12b808d999f9878a26">  366</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::size_t &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a48ae968e35e3bd12b808d999f9878a26">m_lid</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a9024bf48f49f5d13f793dea946355c26">  367</a></span>&#160;    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a9024bf48f49f5d13f793dea946355c26">m_matownpts</a>;    <span class="comment">//!&lt; Size (in bytes) of owned matrix nonzeros</span></div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a470a2431bee63cbf0d6a3ca9689c454d">  368</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a470a2431bee63cbf0d6a3ca9689c454d">m_matcompts</a>;    <span class="comment">//!&lt; size (in bytes) of communicated matrix</span></div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a89a96108ea63db7b4330374af392acbb">  369</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a89a96108ea63db7b4330374af392acbb">m_vecownpts</a>;    <span class="comment">//!&lt; Size (in bytes) of owned vector nonzeros</span></div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a33f86776a739083eacfd9a118f84740c">  370</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a33f86776a739083eacfd9a118f84740c">m_veccompts</a>;    <span class="comment">//!&lt; size (in bytes) of communicated vector</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span><span class="comment">    //! Time stamps</span></div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a65998173fb9f503a5d6fafef49dfea24">  372</a></span>&#160;<span class="comment"></span>    std::vector&lt; std::pair&lt; std::string, tk::real &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a65998173fb9f503a5d6fafef49dfea24">m_timestamp</a>;<span class="comment"></span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">    //! Timer labels</span></div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5">  374</a></span>&#160;<span class="comment"></span>    <span class="keyword">enum class</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5">TimerTag</a> { <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5a8cbc0fb889c6cc21e0be26227a2b468b">LHS</a>, <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5ae80302656805aeec44dc5d789d653c6b">RHS</a>, <a class="code" href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5a46ba9eba2f4b52116787dfa6fb4278e3">SOL</a> };<span class="comment"></span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    //! Timers</span></div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a397ad43640680dd0d61fc093599ce1df">  376</a></span>&#160;<span class="comment"></span>    std::map&lt; TimerTag, tk::Timer &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a397ad43640680dd0d61fc093599ce1df">m_timer</a>;<span class="comment"></span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">    //! Performance statistics</span></div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a1b9012d0160e0c9bc0fb2e7697b45deb">  378</a></span>&#160;<span class="comment"></span>    std::vector&lt; std::pair&lt; std::string, tk::real &gt; &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#a1b9012d0160e0c9bc0fb2e7697b45deb">m_perfstat</a>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">    //! Return processing element for global mesh row id</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    //! \param[in] gid Global mesh point (matrix or vector row) id</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">    //! \return PE that owns global row id</span></div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">  383</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>( std::size_t gid ) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keyword">auto</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a> = gid / <a class="code" href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">m_chunksize</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a> == CkNumPes()) --<a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">pe</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">    //! Check if we have done our part in storing and exporting global row ids</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">    //! \details This does not mean the global row ids on our PE is complete</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">    //!   (which is tested by an assert in rowsreceived), only that we have done</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">    //!   our part of receiving contributions from chare array groups storing</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">    //!   the parts that we own and have sent the parts we do not own to fellow</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">    //!   PEs, i.e., we have nothing else to export. Only when all other fellow</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">    //!   branches have received all contributions are the row ids complete on</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">    //!   all PEs. This latter condition can only be tested after the global</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">    //!   reduction initiated by signal2host_row_complete, which is called when</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">    //!   all fellow branches have returned true from rowcomplete.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">    //! \see rowsreceived()</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">    //! \return True if we have done our part storing and exporting row ids</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a991f044291b07e774e42fb247e77ce8c">  401</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a991f044291b07e774e42fb247e77ce8c">rowcomplete</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">return</span> <span class="comment">// have heard from every chare on my PE</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;             m_myworker.size() == m_nchare &amp;&amp;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;             <span class="comment">// all fellow PEs have received my row ids contribution</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;             m_nperow == 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">    //! Check if our portion of the solution vector values is complete</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">    //! \return True if all parts of the unknown/solution vector have been</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">    //!   received</span></div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a21d19431edcbfc9923e4e256de1ddd2c">  411</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a21d19431edcbfc9923e4e256de1ddd2c">solcomplete</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_solimport == <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">m_rowimport</a>; }<span class="comment"></span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">    //! Check if our portion of the matrix values is complete</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">    //! \return True if all parts of the left-hand side matrix have been</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">    //!   received</span></div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ad4042cd264f54934d02d3aef355e2376">  415</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ad4042cd264f54934d02d3aef355e2376">lhscomplete</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_lhsimport == <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">m_rowimport</a>; }<span class="comment"></span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">    //! Check if our portion of the right-hand side vector values is complete</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">    //! \return True if all parts of the right-hand side vector have been</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">    //!   received</span></div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a6d035d4a0720e49dcbbeda0c3d649f5f">  419</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a6d035d4a0720e49dcbbeda0c3d649f5f">rhscomplete</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_rhsimport == <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">m_rowimport</a>; }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the global row ids</span></div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a6bd3aff0ef10419fd577251a113fe42e">  422</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a6bd3aff0ef10419fd577251a113fe42e">hyprerow</a>() {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : m_row) m_hypreRows.push_back( static_cast&lt; int &gt;( r+1 ) );</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the solution vector</span></div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ad3583c40825f16d2ef8d0bdb451a41c9">  427</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ad3583c40825f16d2ef8d0bdb451a41c9">hypresol</a>() {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#a21d19431edcbfc9923e4e256de1ddd2c">solcomplete</a>(),</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;              <span class="stringliteral">&quot;Values of distributed solution vector on PE &quot;</span> +</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;              std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete&quot;</span> );</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      std::size_t i = 0;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : m_sol) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        m_lid[ r.first ] = i++;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        m_hypreSol.push_back( r.second );</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Build Hypre data for solution vector&quot;</span>,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      trigger_hypresol_complete();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the matrix</span></div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ac2817a2fea34d6fba8e78d9726a522f8">  442</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ac2817a2fea34d6fba8e78d9726a522f8">hyprelhs</a>() {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#ad4042cd264f54934d02d3aef355e2376">lhscomplete</a>(),</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;              <span class="stringliteral">&quot;Nonzero values of distributed matrix on PE &quot;</span> +</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete&quot;</span> );</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( m_lhs.size() == m_hypreRows.size(),</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;              <span class="stringliteral">&quot;Left-hand side matrix incomplete on &quot;</span> +</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              std::to_string(CkMyPe()) );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; r : m_lhs) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        m_hypreNcols.push_back( static_cast&lt; int &gt;( r.second.size() ) );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : r.second) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;           m_hypreCols.push_back( static_cast&lt; int &gt;( c.first+1 ) );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;           m_hypreMat.push_back( c.second );</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Build Hypre data for lhs matrix&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      trigger_hyprelhs_complete();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the right-hand side vector</span></div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a1ff9c20c7e7e955888ffb3797e86ef12">  461</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a1ff9c20c7e7e955888ffb3797e86ef12">hyprerhs</a>() {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_lin_sys_merger.html#a6d035d4a0720e49dcbbeda0c3d649f5f">rhscomplete</a>(),</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;              <span class="stringliteral">&quot;Values of distributed right-hand-side vector on PE &quot;</span> +</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;              std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete&quot;</span> );</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : m_rhs) m_hypreRhs.push_back( r.second );</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Build Hypre data for rhs vector&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      trigger_hyprerhs_complete();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">    //! Set our portion of values of the distributed solution vector</span></div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aa453f098efb706af61dcfa8720882df4">  472</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#aa453f098efb706af61dcfa8720882df4">sol</a>() {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( m_hypreSol.size() == m_hypreRows.size(),</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              <span class="stringliteral">&quot;Solution vector values incomplete on &quot;</span> +</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;              std::to_string(CkMyPe()) );</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="comment">// Set our portion of the vector values</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      m_x.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ae37174fc959e3d8368a0927b46e3ebb1">set</a>( static_cast&lt; int &gt;( m_upper - m_lower ),</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;               m_hypreRows.data(),</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;               m_hypreSol.data() );</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Fill solution vector&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      trigger_fillsol_complete();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">    //! Set our portion of values of the distributed matrix</span></div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">  485</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">lhs</a>() {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( m_hypreMat.size() == m_hypreCols.size(),</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;              <span class="stringliteral">&quot;Matrix values incomplete on &quot;</span> + std::to_string(CkMyPe()) );</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="comment">// Set our portion of the matrix values</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      m_A.<a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html#a3e0a1ad09edace335a847bb06a782ec4">set</a>( static_cast&lt; int &gt;( m_upper - m_lower ),</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;               m_hypreNcols.data(),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;               m_hypreRows.data(),</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;               m_hypreCols.data(),</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;               m_hypreMat.data() );</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Fill left-hand side matrix&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      trigger_filllhs_complete();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">    //! Set our portion of values of the distributed right-hand side vector</span></div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a75f822ec1e0abfa71dadb9e3e6fe03ee">  499</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a75f822ec1e0abfa71dadb9e3e6fe03ee">rhs</a>() {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( m_hypreRhs.size() == m_hypreRows.size(),</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;              <span class="stringliteral">&quot;RHS vector values incomplete on &quot;</span> + std::to_string(CkMyPe()) );</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">// Set our portion of the vector values</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      m_b.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ae37174fc959e3d8368a0927b46e3ebb1">set</a>( static_cast&lt; int &gt;( m_upper - m_lower  ),</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;               m_hypreRows.data(),</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;               m_hypreRhs.data() );</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Fill right-hand side vector&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      trigger_fillrhs_complete();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">    //! Assemble distributed solution vector</span></div>
<div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ad098c151122489841c29855559a314d7">  512</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ad098c151122489841c29855559a314d7">assemblesol</a>() {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      m_x.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">assemble</a>();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Assemble solution vector&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      trigger_asmsol_complete();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">    //! Assemble distributed matrix</span></div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a1b67d384846ab2a89600b80a77473c41">  519</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a1b67d384846ab2a89600b80a77473c41">assemblelhs</a>() {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      m_A.<a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html#a950b0660f03241ea739c61eb79ff55ea">assemble</a>();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Assemble left-hand side matrix&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      trigger_asmlhs_complete();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">    //! Assemble distributed right-hand side vector</span></div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ab818faed985c9290b19adc8dfbbcb137">  526</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ab818faed985c9290b19adc8dfbbcb137">assemblerhs</a>() {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="classtk_1_1_timer.html">tk::Timer</a> t;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      m_b.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">assemble</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      m_timestamp.emplace_back( <span class="stringliteral">&quot;Assemble right-hand side vector&quot;</span>, t.<a class="code" href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">dsec</a>() );</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      trigger_asmrhs_complete();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">    //! Update solution vector in our PE&#39;s performers</span></div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#ab32662904299462ba61b80f8f8c67b2c">  534</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#ab32662904299462ba61b80f8f8c67b2c">updateSolution</a>() {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">// Get solution vector values for our PE</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      m_x.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#aabd7e49669f4109eb1b0f547e04a9940">get</a>( static_cast&lt; int &gt;( m_upper - m_lower ),</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;               m_hypreRows.data(),</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;               m_hypreSol.data() );</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="comment">// Group solution vector by workers and send each the parts back to</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">// workers that own them</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; w : m_solimport) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        std::map&lt; std::size_t, tk::real &gt; <a class="code" href="classtk_1_1_lin_sys_merger.html#aa453f098efb706af61dcfa8720882df4">sol</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : w.second) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> it = m_sol.find( r );</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="namespacekw.html#a3d5542e9817eb16f871c22a15595e837">end</a>(m_sol))</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            sol.emplace( it-&gt;first,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                         m_hypreSol[ <a class="code" href="namespacetk.html#a6c68c42b8cf1dd91142411308913a13e">tk::lid</a>(m_lid,it-&gt;first) ] );</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Can&#39;t find global row id &quot;</span> + std::to_string(r) +</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                   <span class="stringliteral">&quot; to export in solution vector&quot;</span> );</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        m_worker[ w.first ].updateSolution( sol );</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">    //! Solve linear system</span></div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#aa727fddd2f853aa3cb979d839bb1b059">  557</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#aa727fddd2f853aa3cb979d839bb1b059">solve</a>() {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      m_solver.<a class="code" href="classtk_1_1hypre_1_1_hypre_solver.html#a850743816fec66e972d0995ae592895c">solve</a>( m_A, m_b, m_x );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      m_x.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#a21b4647a1a3d8ebc34e034f05b406983">print</a>( <span class="stringliteral">&quot;hypre_sol&quot;</span> );</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="classtk_1_1_lin_sys_merger.html#ab32662904299462ba61b80f8f8c67b2c">updateSolution</a>();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">    /** @name Host signal calls</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">      * \brief These functions signal back to the host via a global reduction</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">      *   originating from each PE branch</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">      * \details Singal calls contribute to a reduction on all branches (PEs)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">      *   of LinSysMerger to the host, e.g., inciter::CProxy_Conductor, given by</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">      *   the template argument HostProxy. The signal functions are overloads on</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">      *   the specialization, e.g., inciter::CProxy_Conductor, of the</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">      *   LinSysMerger template. They create Charm++ reduction targets via</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">      *   creating a callback that invokes the typed reduction client, where</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">      *   host is the proxy on which the reduction target method, given by the</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">      *   string followed by &quot;redn_wrapper_&quot;, e.g., init(), is called upon</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">      *   completion of the reduction.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">      *</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">      *   Note that we do not use Charm++&#39;s CkReductionTarget macro here,</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">      *   but instead explicitly generate the code that that macro would</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">      *   generate. To explain why, here is Charm++&#39;s CkReductionTarget macro&#39;s</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">      *   definition, given in ckreduction.h:</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">      *   \code{.cpp}</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">      *      #define CkReductionTarget(me, method) \</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">      *        CkIndex_##me::redn_wrapper_##method(NULL)</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">      *   \endcode</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">      *   This macro takes arguments &#39;me&#39; (a class name) and &#39;method&#39; a member</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">      *   function of class &#39;me&#39; and generates the call</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">      *   &#39;CkIndex_&lt;class&gt;::redn_wrapper_&lt;method&gt;(NULL)&#39;. With the overloads the</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">      *   signal2* functions generate, we do the above macro&#39;s job for</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">      *   LinSysMerger specialized by HostProxy, hard-coded here, as well its</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">      *   reduction target. This is required since</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">      *    * Charm++&#39;s CkReductionTarget macro&#39;s preprocessing happens earlier</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">      *      than type resolution and the string of the template argument would</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">      *      be substituted instead of the type specialized (which is not what</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">      *      we want here), and</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">      *    * the template argument class, e.g, CProxy_Conductor, is in a</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">      *      namespace different than that of LinSysMerger. When a new class is</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">      *      used to specialize LinSysMerger, the compiler will alert that a new</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">      *      overload needs to be defined.</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">      *</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">      * \note This simplifies client-code, e.g., inciter::Conductor, which now</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">      *   requires no explicit book-keeping with counters, etc. Also a reduction</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">      *   (instead of a direct call to the host) better utilizes the</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">      *   communication network as computational nodes can send their aggregated</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">      *   contribution to other nodes on a network instead of all chares sending</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">      *   their (smaller) contributions to the same host, (hopefully)</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">      *   implemented using a tree among the PEs.</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">      * \see http://charm.cs.illinois.edu/manuals/html/charm++/manual.html,</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">      *   Sections &quot;Processor-Aware Chare Collections&quot; and &quot;Chare Arrays&quot;.</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">      * */</span><span class="comment"></span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">    ///@{</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">    //! \brief Signal back to host that the initialization of the linear system</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">    //!   is complete</span></div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a378acdeb0e2b15dc76943973472d6bc8">  612</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a378acdeb0e2b15dc76943973472d6bc8">signal2host_init_complete</a>( <span class="keyword">const</span> inciter::CProxy_Conductor&amp; host ) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keyword">using</span> inciter::CkIndex_Conductor;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      Group::contribute(</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        CkCallback( CkIndex_Conductor::redn_wrapper_init(NULL), host )</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      );</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">    //! \brief Signal back to host that the initialization of the row indices of</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">    //!   the linear system is complete</span></div>
<div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="classtk_1_1_lin_sys_merger.html#a8779518d1ed304624a4ad9baee602642">  621</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_lin_sys_merger.html#a8779518d1ed304624a4ad9baee602642">signal2host_row_complete</a>( <span class="keyword">const</span> inciter::CProxy_Conductor&amp; host ) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keyword">using</span> inciter::CkIndex_Conductor;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      Group::contribute(</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        CkCallback( CkIndex_Conductor::redn_wrapper_rowcomplete(NULL), host )</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      );</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }<span class="comment"></span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">    ///@}</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span>};</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;} <span class="comment">// tk::</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#if defined(__clang__) || defined(__GNUC__)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic ignored &quot;-Wconversion&quot;</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="_lin_sys_merger_8h.html#a6ec0c67374eb34a66c0f5ca4ecd7d163">  637</a></span>&#160;<span class="preprocessor">#define CK_TEMPLATES_ONLY</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">#include &quot;linsysmerger.def.h&quot;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">#undef CK_TEMPLATES_ONLY</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">#if defined(__clang__) || defined(__GNUC__)</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#endif // LinSysMerger_h</span></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ace0efc6863397e91df1fa9cfb3899686"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ace0efc6863397e91df1fa9cfb3899686">tk::LinSysMerger::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, tk::real &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE: global mesh point row ids and values. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00341">LinSysMerger.h:341</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a11c7492ec2d3c9451cc4503f9ccad72a"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a11c7492ec2d3c9451cc4503f9ccad72a">tk::LinSysMerger::recrow</a></div><div class="ttdeci">void recrow()</div><div class="ttdoc">Acknowledge received row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00162">LinSysMerger.h:162</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ac0428fffd8e423b0d8de48d43f26d944"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">tk::hypre::HypreVector::assemble</a></div><div class="ttdeci">void assemble()</div><div class="ttdoc">Assemble vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00060">HypreVector.h:60</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a1b67d384846ab2a89600b80a77473c41"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a1b67d384846ab2a89600b80a77473c41">tk::LinSysMerger::assemblelhs</a></div><div class="ttdeci">void assemblelhs()</div><div class="ttdoc">Assemble distributed matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00519">LinSysMerger.h:519</a></div></div>
<div class="ttc" id="_performer_8h_html"><div class="ttname"><a href="_performer_8h.html">Performer.h</a></div><div class="ttdoc">Performer advances a PDE. </div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_abae5f3da7b602eb55a6378a111fffded"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#abae5f3da7b602eb55a6378a111fffded">tk::LinSysMerger::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00320">LinSysMerger.h:320</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a89a96108ea63db7b4330374af392acbb"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a89a96108ea63db7b4330374af392acbb">tk::LinSysMerger::m_vecownpts</a></div><div class="ttdeci">std::size_t m_vecownpts</div><div class="ttdoc">Size (in bytes) of owned vector nonzeros. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00369">LinSysMerger.h:369</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_acd88a821f7be31d21680f88b468715b5"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#acd88a821f7be31d21680f88b468715b5">tk::LinSysMerger::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00319">LinSysMerger.h:319</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a991f044291b07e774e42fb247e77ce8c"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a991f044291b07e774e42fb247e77ce8c">tk::LinSysMerger::rowcomplete</a></div><div class="ttdeci">bool rowcomplete() const </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00401">LinSysMerger.h:401</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a6500e7136397e4486379afe48a4e23d3"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a6500e7136397e4486379afe48a4e23d3">tk::LinSysMerger::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00348">LinSysMerger.h:348</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a33f86776a739083eacfd9a118f84740c"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a33f86776a739083eacfd9a118f84740c">tk::LinSysMerger::m_veccompts</a></div><div class="ttdeci">std::size_t m_veccompts</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00370">LinSysMerger.h:370</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a8779518d1ed304624a4ad9baee602642"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a8779518d1ed304624a4ad9baee602642">tk::LinSysMerger::signal2host_row_complete</a></div><div class="ttdeci">void signal2host_row_complete(const inciter::CProxy_Conductor &amp;host)</div><div class="ttdoc">Signal back to host that the initialization of the row indices of the linear system is complete...</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00621">LinSysMerger.h:621</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_aabd7e49669f4109eb1b0f547e04a9940"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#aabd7e49669f4109eb1b0f547e04a9940">tk::hypre::HypreVector::get</a></div><div class="ttdeci">void get(int nvalues, const int *indices, HYPRE_Complex *values)</div><div class="ttdoc">Get the local vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00056">HypreVector.h:56</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a></div><div class="ttdoc">Hypre vector class. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00030">HypreVector.h:30</a></div></div>
<div class="ttc" id="classtk_1_1_timer_html"><div class="ttname"><a href="classtk_1_1_timer.html">tk::Timer</a></div><div class="ttdef"><b>Definition:</b> <a href="_timer_8h_source.html#l00039">Timer.h:39</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html_a3e0a1ad09edace335a847bb06a782ec4"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html#a3e0a1ad09edace335a847bb06a782ec4">tk::hypre::HypreMatrix::set</a></div><div class="ttdeci">void set(int nrows, int *ncols, const int *rows, const int *cols, const HYPRE_Complex *values)</div><div class="ttdoc">Set values of matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00054">HypreMatrix.h:54</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_af30bc56154a6833a3c13e95430467f06"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#af30bc56154a6833a3c13e95430467f06">tk::LinSysMerger::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00338">LinSysMerger.h:338</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html_a51a6fa96ea67c8cd696b97ed9a2a06a7"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html#a51a6fa96ea67c8cd696b97ed9a2a06a7">tk::hypre::HypreMatrix::create</a></div><div class="ttdeci">void create(std::size_t lower, std::size_t upper)</div><div class="ttdoc">Create and initialize Hypre IJ matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00034">HypreMatrix.h:34</a></div></div>
<div class="ttc" id="namespacetk_html_a6c68c42b8cf1dd91142411308913a13e"><div class="ttname"><a href="namespacetk.html#a6c68c42b8cf1dd91142411308913a13e">tk::lid</a></div><div class="ttdeci">std::map&lt; Key, Value &gt;::size_type lid(const std::map&lt; Key, Value &gt; &amp;map, Key key)</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00090">ContainerUtil.h:90</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a69d554c92c5c157f0146333a74c1dd5e"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a69d554c92c5c157f0146333a74c1dd5e">tk::LinSysMerger::pe</a></div><div class="ttdeci">std::size_t pe(std::size_t gid)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00383">LinSysMerger.h:383</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a9024bf48f49f5d13f793dea946355c26"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a9024bf48f49f5d13f793dea946355c26">tk::LinSysMerger::m_matownpts</a></div><div class="ttdeci">std::size_t m_matownpts</div><div class="ttdoc">Size (in bytes) of owned matrix nonzeros. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00367">LinSysMerger.h:367</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a23769b496dbe36fb763a0c17fbbe85c4"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a23769b496dbe36fb763a0c17fbbe85c4">tk::LinSysMerger::m_solver</a></div><div class="ttdeci">tk::hypre::HypreSolver m_solver</div><div class="ttdoc">Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00352">LinSysMerger.h:352</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ac60c4df056ed06e98447bd2264576c5f"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ac60c4df056ed06e98447bd2264576c5f">tk::hypre::HypreVector::create</a></div><div class="ttdeci">void create(std::size_t lower, std::size_t upper)</div><div class="ttdoc">Create and initialize Hypre IJ vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00034">HypreVector.h:34</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a6d035d4a0720e49dcbbeda0c3d649f5f"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a6d035d4a0720e49dcbbeda0c3d649f5f">tk::LinSysMerger::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00419">LinSysMerger.h:419</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a05f9d2460aa9d93e9f7bec8927b4e815"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a05f9d2460aa9d93e9f7bec8927b4e815">tk::LinSysMerger::addsol</a></div><div class="ttdeci">void addsol(int fromch, const std::map&lt; std::size_t, tk::real &gt; &amp;sol)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00198">LinSysMerger.h:198</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ad4042cd264f54934d02d3aef355e2376"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ad4042cd264f54934d02d3aef355e2376">tk::LinSysMerger::lhscomplete</a></div><div class="ttdeci">bool lhscomplete() const </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00415">LinSysMerger.h:415</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a72df0d200bd61c88eec0fd2fe00698ce"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a72df0d200bd61c88eec0fd2fe00698ce">tk::LinSysMerger::m_host</a></div><div class="ttdeci">HostProxy m_host</div><div class="ttdoc">Host proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00316">LinSysMerger.h:316</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_solver_html_a5e3ef63b60590577a079082d5a1f028f"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_solver.html#a5e3ef63b60590577a079082d5a1f028f">tk::hypre::HypreSolver::create</a></div><div class="ttdeci">void create()</div><div class="ttdoc">Create and initialize Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_solver_8h_source.html#l00036">HypreSolver.h:36</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aefd53b197c19f8a801c36dc2aae61583"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aefd53b197c19f8a801c36dc2aae61583">tk::LinSysMerger::m_hypreNcols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreNcols</div><div class="ttdoc">Number of matrix columns/rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00356">LinSysMerger.h:356</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a97fb6e9331b0ff278a070fb4abe328e0"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a97fb6e9331b0ff278a070fb4abe328e0">tk::LinSysMerger::m_hypreCols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreCols</div><div class="ttdoc">Matrix column indices for rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00358">LinSysMerger.h:358</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a75f822ec1e0abfa71dadb9e3e6fe03ee"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a75f822ec1e0abfa71dadb9e3e6fe03ee">tk::LinSysMerger::rhs</a></div><div class="ttdeci">void rhs()</div><div class="ttdoc">Set our portion of values of the distributed right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00499">LinSysMerger.h:499</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a48ae968e35e3bd12b808d999f9878a26"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a48ae968e35e3bd12b808d999f9878a26">tk::LinSysMerger::m_lid</a></div><div class="ttdeci">std::map&lt; std::size_t, std::size_t &gt; m_lid</div><div class="ttdoc">Global->local row id map for sending back solution vector parts. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00366">LinSysMerger.h:366</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aeee2a3d196324a906267b0ebd12a2654"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aeee2a3d196324a906267b0ebd12a2654">tk::LinSysMerger::m_hypreRhs</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreRhs</div><div class="ttdoc">RHS vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00362">LinSysMerger.h:362</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a4648517e73f2f267abb8fb9f31fc3c7b"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a4648517e73f2f267abb8fb9f31fc3c7b">tk::LinSysMerger::charesol</a></div><div class="ttdeci">void charesol(int fromch, const std::map&lt; std::size_t, tk::real &gt; &amp;sol)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00173">LinSysMerger.h:173</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a9d4cbf067e6e054c5813825b42b8387b"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a9d4cbf067e6e054c5813825b42b8387b">tk::LinSysMerger::m_chunksize</a></div><div class="ttdeci">std::size_t m_chunksize</div><div class="ttdoc">Number of rows the first npe-1 PE own. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00318">LinSysMerger.h:318</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ad098c151122489841c29855559a314d7"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ad098c151122489841c29855559a314d7">tk::LinSysMerger::assemblesol</a></div><div class="ttdeci">void assemblesol()</div><div class="ttdoc">Assemble distributed solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00512">LinSysMerger.h:512</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html_a950b0660f03241ea739c61eb79ff55ea"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html#a950b0660f03241ea739c61eb79ff55ea">tk::hypre::HypreMatrix::assemble</a></div><div class="ttdeci">void assemble()</div><div class="ttdoc">Assemble matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00059">HypreMatrix.h:59</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a6a2342bf25787ba16667e0f58fe35872"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a6a2342bf25787ba16667e0f58fe35872">tk::LinSysMerger::rowsreceived</a></div><div class="ttdeci">void rowsreceived()</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00301">LinSysMerger.h:301</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aa509f2f499e9a43563d4f13684292337"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aa509f2f499e9a43563d4f13684292337">tk::LinSysMerger::checkin</a></div><div class="ttdeci">void checkin()</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00115">LinSysMerger.h:115</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a1b9012d0160e0c9bc0fb2e7697b45deb"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a1b9012d0160e0c9bc0fb2e7697b45deb">tk::LinSysMerger::m_perfstat</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, tk::real &gt; &gt; m_perfstat</div><div class="ttdoc">Performance statistics. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00378">LinSysMerger.h:378</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a231c27b322a336a6fb430287fd265eb7"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a231c27b322a336a6fb430287fd265eb7">tk::LinSysMerger::m_lhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00333">LinSysMerger.h:333</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a5d8fe3ee878ace7f630fb2d9ac270a3c"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a5d8fe3ee878ace7f630fb2d9ac270a3c">tk::LinSysMerger::lhs</a></div><div class="ttdeci">void lhs()</div><div class="ttdoc">Set our portion of values of the distributed matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00485">LinSysMerger.h:485</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_a21b4647a1a3d8ebc34e034f05b406983"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#a21b4647a1a3d8ebc34e034f05b406983">tk::hypre::HypreVector::print</a></div><div class="ttdeci">void print(const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00066">HypreVector.h:66</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a721f4b7e69eeb0027ac4f981f7e2a193"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a721f4b7e69eeb0027ac4f981f7e2a193">tk::LinSysMerger::m_worker</a></div><div class="ttdeci">WorkerProxy m_worker</div><div class="ttdoc">Worker proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00317">LinSysMerger.h:317</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_acb58face0945dd27bd92fbf715c5e288"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#acb58face0945dd27bd92fbf715c5e288">tk::LinSysMerger::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00324">LinSysMerger.h:324</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a415897ff76dd044688f209aa647c9aaf"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a415897ff76dd044688f209aa647c9aaf">tk::LinSysMerger::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, tk::real &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE: global mesh point row and column ids, and nonzero value. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00344">LinSysMerger.h:344</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ab194ea640949641ee24cbb83b28425bc"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ab194ea640949641ee24cbb83b28425bc">tk::LinSysMerger::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00330">LinSysMerger.h:330</a></div></div>
<div class="ttc" id="_exception_8h_html"><div class="ttname"><a href="_exception_8h.html">Exception.h</a></div><div class="ttdoc">Exception class declaration. </div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html">tk::LinSysMerger</a></div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00054">LinSysMerger.h:54</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a65998173fb9f503a5d6fafef49dfea24"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a65998173fb9f503a5d6fafef49dfea24">tk::LinSysMerger::m_timestamp</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, tk::real &gt; &gt; m_timestamp</div><div class="ttdoc">Time stamps. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00372">LinSysMerger.h:372</a></div></div>
<div class="ttc" id="_timer_8h_html"><div class="ttname"><a href="_timer_8h.html">Timer.h</a></div><div class="ttdoc">Timer declaration. </div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ad3583c40825f16d2ef8d0bdb451a41c9"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ad3583c40825f16d2ef8d0bdb451a41c9">tk::LinSysMerger::hypresol</a></div><div class="ttdeci">void hypresol()</div><div class="ttdoc">Build Hypre data for our portion of the solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00427">LinSysMerger.h:427</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a859798eec68b98a1de58a120cf7aa641"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a859798eec68b98a1de58a120cf7aa641">tk::LinSysMerger::m_hypreSol</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreSol</div><div class="ttdoc">Sol vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00364">LinSysMerger.h:364</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ac2817a2fea34d6fba8e78d9726a522f8"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ac2817a2fea34d6fba8e78d9726a522f8">tk::LinSysMerger::hyprelhs</a></div><div class="ttdeci">void hyprelhs()</div><div class="ttdoc">Build Hypre data for our portion of the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00442">LinSysMerger.h:442</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_adf7f86528567c210aa2228782d802e8e"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#adf7f86528567c210aa2228782d802e8e">tk::LinSysMerger::LinSysMerger</a></div><div class="ttdeci">LinSysMerger(HostProxy &amp;host, std::size_t npoin)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00067">LinSysMerger.h:67</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ab32662904299462ba61b80f8f8c67b2c"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ab32662904299462ba61b80f8f8c67b2c">tk::LinSysMerger::updateSolution</a></div><div class="ttdeci">void updateSolution()</div><div class="ttdoc">Update solution vector in our PE&#39;s performers. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00534">LinSysMerger.h:534</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a227e7127f4075b65f312b405e2584737"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a227e7127f4075b65f312b405e2584737">tk::LinSysMerger::Group</a></div><div class="ttdeci">CBase_LinSysMerger&lt; HostProxy, WorkerProxy &gt; Group</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00061">LinSysMerger.h:61</a></div></div>
<div class="ttc" id="_hypre_vector_8h_html"><div class="ttname"><a href="_hypre_vector_8h.html">HypreVector.h</a></div><div class="ttdoc">Hypre IJ vector class. </div></div>
<div class="ttc" id="namespacekw_html_a3d5542e9817eb16f871c22a15595e837"><div class="ttname"><a href="namespacekw.html#a3d5542e9817eb16f871c22a15595e837">kw::end</a></div><div class="ttdeci">keyword&lt; end_info, e, n, d &gt; end</div><div class="ttdef"><b>Definition:</b> <a href="_keywords_8h_source.html#l00174">Keywords.h:174</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a0b910dcaf03dbcdadf9187b9b1514941"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a0b910dcaf03dbcdadf9187b9b1514941">tk::LinSysMerger::m_hypreMat</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreMat</div><div class="ttdoc">Matrix nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00360">LinSysMerger.h:360</a></div></div>
<div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00034">Exception.h:34</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a9b41f198685edf0517cc542616a6866e"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a9b41f198685edf0517cc542616a6866e">tk::LinSysMerger::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00322">LinSysMerger.h:322</a></div></div>
<div class="ttc" id="_container_util_8h_html"><div class="ttname"><a href="_container_util_8h.html">ContainerUtil.h</a></div><div class="ttdoc">Various STL container utilities. </div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ae37174fc959e3d8368a0927b46e3ebb1"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ae37174fc959e3d8368a0927b46e3ebb1">tk::hypre::HypreVector::set</a></div><div class="ttdeci">void set(int nvalues, const int *indices, const HYPRE_Complex *values)</div><div class="ttdoc">Set values of vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00052">HypreVector.h:52</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aa727fddd2f853aa3cb979d839bb1b059"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aa727fddd2f853aa3cb979d839bb1b059">tk::LinSysMerger::solve</a></div><div class="ttdeci">void solve()</div><div class="ttdoc">Solve linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00557">LinSysMerger.h:557</a></div></div>
<div class="ttc" id="_hypre_solver_8h_html"><div class="ttname"><a href="_hypre_solver_8h.html">HypreSolver.h</a></div><div class="ttdoc">Hypre solver class. </div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a1ff9c20c7e7e955888ffb3797e86ef12"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a1ff9c20c7e7e955888ffb3797e86ef12">tk::LinSysMerger::hyprerhs</a></div><div class="ttdeci">void hyprerhs()</div><div class="ttdoc">Build Hypre data for our portion of the right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00461">LinSysMerger.h:461</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aefba1ac88619564e84c39b7664a2b146"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aefba1ac88619564e84c39b7664a2b146">tk::LinSysMerger::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00354">LinSysMerger.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a2fbe692f16f50ec745785a81f0c78ce5ae80302656805aeec44dc5d789d653c6b"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5ae80302656805aeec44dc5d789d653c6b">tk::LinSysMerger::TimerTag::RHS</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a2fbe692f16f50ec745785a81f0c78ce5a8cbc0fb889c6cc21e0be26227a2b468b"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5a8cbc0fb889c6cc21e0be26227a2b468b">tk::LinSysMerger::TimerTag::LHS</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ad9f98cef0219ba6d601076c13fe1308f"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ad9f98cef0219ba6d601076c13fe1308f">tk::LinSysMerger::create</a></div><div class="ttdeci">void create()</div><div class="ttdoc">Create linear system, i.e., left-hand side matrix, vector of unknowns, right-hand side vector...</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00100">LinSysMerger.h:100</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a378acdeb0e2b15dc76943973472d6bc8"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a378acdeb0e2b15dc76943973472d6bc8">tk::LinSysMerger::signal2host_init_complete</a></div><div class="ttdeci">void signal2host_init_complete(const inciter::CProxy_Conductor &amp;host)</div><div class="ttdoc">Signal back to host that the initialization of the linear system is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00612">LinSysMerger.h:612</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a67367a8cc6e70c81f42b8601a8359bd2"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a67367a8cc6e70c81f42b8601a8359bd2">tk::LinSysMerger::m_A</a></div><div class="ttdeci">tk::hypre::HypreMatrix m_A</div><div class="ttdoc">Hypre matrix to store the left-hand side. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00349">LinSysMerger.h:349</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_ab818faed985c9290b19adc8dfbbcb137"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#ab818faed985c9290b19adc8dfbbcb137">tk::LinSysMerger::assemblerhs</a></div><div class="ttdeci">void assemblerhs()</div><div class="ttdoc">Assemble distributed right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00526">LinSysMerger.h:526</a></div></div>
<div class="ttc" id="classtk_1_1_timer_html_a08304f78d80271af5adc8115d6d55a93"><div class="ttname"><a href="classtk_1_1_timer.html#a08304f78d80271af5adc8115d6d55a93">tk::Timer::dsec</a></div><div class="ttdeci">real dsec() const </div><div class="ttdef"><b>Definition:</b> <a href="_timer_8h_source.html#l00071">Timer.h:71</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_solver_html_a850743816fec66e972d0995ae592895c"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_solver.html#a850743816fec66e972d0995ae592895c">tk::hypre::HypreSolver::solve</a></div><div class="ttdeci">void solve(const HypreMatrix &amp;A, const HypreVector &amp;b, const HypreVector &amp;x) const </div><div class="ttdoc">Solve the linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_solver_8h_source.html#l00048">HypreSolver.h:48</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aa351412964251e1670fd19d08433b44e"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aa351412964251e1670fd19d08433b44e">tk::LinSysMerger::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00336">LinSysMerger.h:336</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a960eb6ab61761ff9c8b4cd956bca4806"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a960eb6ab61761ff9c8b4cd956bca4806">tk::LinSysMerger::charerow</a></div><div class="ttdeci">void charerow(WorkerProxy &amp;worker, int fromch, const std::vector&lt; std::size_t &gt; &amp;row)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00123">LinSysMerger.h:123</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a6bd3aff0ef10419fd577251a113fe42e"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a6bd3aff0ef10419fd577251a113fe42e">tk::LinSysMerger::hyprerow</a></div><div class="ttdeci">void hyprerow()</div><div class="ttdoc">Build Hypre data for our portion of the global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00422">LinSysMerger.h:422</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a2fbe692f16f50ec745785a81f0c78ce5"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5">tk::LinSysMerger::TimerTag</a></div><div class="ttdeci">TimerTag</div><div class="ttdoc">Timer labels. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00374">LinSysMerger.h:374</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_solver_html"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_solver.html">tk::hypre::HypreSolver</a></div><div class="ttdoc">Hypre matrix class. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_solver_8h_source.html#l00032">HypreSolver.h:32</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a470a2431bee63cbf0d6a3ca9689c454d"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a470a2431bee63cbf0d6a3ca9689c454d">tk::LinSysMerger::m_matcompts</a></div><div class="ttdeci">std::size_t m_matcompts</div><div class="ttdoc">size (in bytes) of communicated matrix </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00368">LinSysMerger.h:368</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_af26f3da27e4f2a636bd171c06e460def"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#af26f3da27e4f2a636bd171c06e460def">tk::LinSysMerger::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, tk::real &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE: global mesh point row ids and values. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00347">LinSysMerger.h:347</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a397ad43640680dd0d61fc093599ce1df"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a397ad43640680dd0d61fc093599ce1df">tk::LinSysMerger::m_timer</a></div><div class="ttdeci">std::map&lt; TimerTag, tk::Timer &gt; m_timer</div><div class="ttdoc">Timers. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00376">LinSysMerger.h:376</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a1b7805fe7ecbc7e003556252130b30ae"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a1b7805fe7ecbc7e003556252130b30ae">tk::LinSysMerger::charerhs</a></div><div class="ttdeci">void charerhs(int fromch, const std::map&lt; std::size_t, tk::real &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00263">LinSysMerger.h:263</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a1645eb91aea46b08342c9bcdd661e740"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a1645eb91aea46b08342c9bcdd661e740">tk::LinSysMerger::addlhs</a></div><div class="ttdeci">void addlhs(int fromch, const std::map&lt; std::size_t, std::map&lt; std::size_t, tk::real &gt; &gt; &amp;lhs)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00246">LinSysMerger.h:246</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a46d77ef343eda99009bb11f25e100860"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a46d77ef343eda99009bb11f25e100860">tk::LinSysMerger::charelhs</a></div><div class="ttdeci">void charelhs(int fromch, const std::map&lt; std::size_t, std::map&lt; std::size_t, tk::real &gt; &gt; &amp;lhs)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00212">LinSysMerger.h:212</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_aa453f098efb706af61dcfa8720882df4"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#aa453f098efb706af61dcfa8720882df4">tk::LinSysMerger::sol</a></div><div class="ttdeci">void sol()</div><div class="ttdoc">Set our portion of values of the distributed solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00472">LinSysMerger.h:472</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a2fbe692f16f50ec745785a81f0c78ce5a46ba9eba2f4b52116787dfa6fb4278e3"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a2fbe692f16f50ec745785a81f0c78ce5a46ba9eba2f4b52116787dfa6fb4278e3">tk::LinSysMerger::TimerTag::SOL</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a5fe4b99df3ff55d783d4965b29186d96"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a5fe4b99df3ff55d783d4965b29186d96">tk::LinSysMerger::m_b</a></div><div class="ttdeci">tk::hypre::HypreVector m_b</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00350">LinSysMerger.h:350</a></div></div>
<div class="ttc" id="namespacetk_html"><div class="ttname"><a href="namespacetk.html">tk</a></div><div class="ttdoc">Toolkit declarations and definitions for general purpose utilities. </div><div class="ttdef"><b>Definition:</b> <a href="_charm_util_8h_source.html#l00016">CharmUtil.h:16</a></div></div>
<div class="ttc" id="_hypre_matrix_8h_html"><div class="ttname"><a href="_hypre_matrix_8h.html">HypreMatrix.h</a></div><div class="ttdoc">Hypre IJ matrix class. </div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a21d19431edcbfc9923e4e256de1ddd2c"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a21d19431edcbfc9923e4e256de1ddd2c">tk::LinSysMerger::solcomplete</a></div><div class="ttdeci">bool solcomplete() const </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00411">LinSysMerger.h:411</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a32b1d1936142b1418fe701b9256c8d7c"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a32b1d1936142b1418fe701b9256c8d7c">tk::LinSysMerger::addrow</a></div><div class="ttdeci">void addrow(int fromch, int frompe, const std::set&lt; std::size_t &gt; &amp;row)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00154">LinSysMerger.h:154</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a269877a4716257ebe616d5579cbe43e2"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a269877a4716257ebe616d5579cbe43e2">tk::LinSysMerger::addrhs</a></div><div class="ttdeci">void addrhs(int fromch, const std::map&lt; std::size_t, tk::real &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00289">LinSysMerger.h:289</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a0113d46a268b90832e1d1332bb521bf2"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a0113d46a268b90832e1d1332bb521bf2">tk::LinSysMerger::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00321">LinSysMerger.h:321</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html">tk::hypre::HypreMatrix</a></div><div class="ttdoc">Hypre matrix class. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00030">HypreMatrix.h:30</a></div></div>
<div class="ttc" id="classtk_1_1_lin_sys_merger_html_a1ac1474d8441998e537a157ce3dd3fdc"><div class="ttname"><a href="classtk_1_1_lin_sys_merger.html#a1ac1474d8441998e537a157ce3dd3fdc">tk::LinSysMerger::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_lin_sys_merger_8h_source.html#l00327">LinSysMerger.h:327</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_877f8e86388d44f0658eb9c256921e40.html">src</a></li><li class="navelem"><a class="el" href="dir_f8889a8ca376b6300d1ffcbbc59ce72b.html">LinSys</a></li><li class="navelem"><a class="el" href="_lin_sys_merger_8h.html">LinSysMerger.h</a></li>
    <li class="footer">Generated on Tue Aug 11 2015 17:55:38 for Quinoa by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
