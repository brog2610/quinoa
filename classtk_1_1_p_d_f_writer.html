<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Quinoa: tk::PDFWriter Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Documents</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classtk_1_1_p_d_f_writer.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">tk::PDFWriter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="tk::PDFWriter" --><!-- doxytag: inherits="tk::Writer" -->
<p><a class="el" href="classtk_1_1_p_d_f_writer.html" title="PDFWriter : Writer.">PDFWriter</a> : <a class="el" href="classtk_1_1_writer.html">Writer</a>.  
 <a href="classtk_1_1_p_d_f_writer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_p_d_f_writer_8h_source.html">PDFWriter.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for tk::PDFWriter:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer__inherit__graph.svg" width="112" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#ad866a267ce43916618205da175312bba">PDFWriter</a> (const std::string &amp;filename, <a class="el" href="namespacetk_1_1ctr.html#a270ba0ac9d911f0e874828015f82a28b">tk::ctr::TxtFloatFormatType</a> format=tk::ctr::TxtFloatFormatType::DEFAULT, kw::precision::info::expect::type precision=std::cout.precision())</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ad866a267ce43916618205da175312bba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a1f798f74e0d815b8bc9e409fbc7da85c">writeTxt</a> (const <a class="el" href="classtk_1_1_uni_p_d_f.html">UniPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write univariate PDF to text file.  <a href="#a1f798f74e0d815b8bc9e409fbc7da85c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a030e93d822be2adcfd0f43ee46505cbd">writeTxt</a> (const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write bivariate PDF to text file.  <a href="#a030e93d822be2adcfd0f43ee46505cbd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a9a0572ffefffc20b60111327e220e3a6">writeTxt</a> (const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write trivariate PDF to text file.  <a href="#a9a0572ffefffc20b60111327e220e3a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a008d30e8fbef66672f922e507cebe481">writeGmshTxt</a> (const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write bivariate PDF to gmsh (text) file format.  <a href="#a008d30e8fbef66672f922e507cebe481"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#af2a0728ea2308ddde703ba63abb72ffc">writeGmshTxt</a> (const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write trivariate PDF to gmsh (text) file format.  <a href="#af2a0728ea2308ddde703ba63abb72ffc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a739e93034fb1c506b1adbb7e57d771a4">writeGmshBin</a> (const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write bivariate PDF to gmsh (binary) file format.  <a href="#a739e93034fb1c506b1adbb7e57d771a4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a37505b9d24c467fd6164a9203a719a92">writeGmshBin</a> (const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write trivariate PDF to gmsh (binary) file format.  <a href="#a37505b9d24c467fd6164a9203a719a92"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a6af1046645c630f1f169b9c99a82250e">writeExodusII</a> (const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info, std::size_t it, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write bivariate PDF to Exodus II file format.  <a href="#a6af1046645c630f1f169b9c99a82250e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a0d07cbcd15d3a6d40c27cc5438e7af42">writeExodusII</a> (const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;pdf, const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;info, std::size_t it, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write trivariate PDF to Exodus II file format.  <a href="#a0d07cbcd15d3a6d40c27cc5438e7af42"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;std::size_t size, class Container &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a6685648a5b3e5bf52ecde7cff310c476">assertSampleSpaceDimensions</a> (const Container &amp;c) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Assert the number of sample space dimensions given.  <a href="#a6685648a5b3e5bf52ecde7cff310c476"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;std::size_t size, class Container &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a5aca398fbfa7c4e3c0104f7d7258fe6d">assertSampleSpaceExtents</a> (const Container &amp;c) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Assert the number of sample space extents given.  <a href="#a5aca398fbfa7c4e3c0104f7d7258fe6d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a7743163b6192e4767627137ba2463fe7">createExFile</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a30df2472b4cb140d9231bbbb28a0679e">writeExHdr</a> (int outFileId, int nnode, int nelem) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a7be8c9494b06b799f81b0a249567da3f">writeExVar</a> (int exoFile, std::size_t it, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering, const std::vector&lt; tk::real &gt; &amp;probability) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae">extents</a> (const <a class="el" href="classtk_1_1_uni_p_d_f.html">UniPDF</a> &amp;pdf, const std::vector&lt; tk::real &gt; &amp;uext, std::size_t &amp;nbi, tk::real &amp;min, tk::real &amp;max, tk::real &amp;binsize, std::array&lt; long, 2 *<a class="el" href="classtk_1_1_uni_p_d_f.html#a8b2515fa9239e8b634a803db1935b25f">UniPDF::dim</a> &gt; &amp;ext, std::vector&lt; tk::real &gt; &amp;outpdf) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query extents and other metadata of univariate PDF sample space.  <a href="#a58e74d6f045704bd1f9c6698e6a779ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#a61a0c52d1e78abd4c5c11fee96577183">extents</a> (const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;pdf, const std::vector&lt; tk::real &gt; &amp;uext, std::size_t &amp;nbix, std::size_t &amp;nbiy, tk::real &amp;xmin, tk::real &amp;xmax, tk::real &amp;ymin, tk::real &amp;ymax, std::array&lt; tk::real, <a class="el" href="classtk_1_1_bi_p_d_f.html#aa61758933e172269a7547ab83c157dc1">BiPDF::dim</a> &gt; &amp;binsize, std::array&lt; long, 2 *<a class="el" href="classtk_1_1_bi_p_d_f.html#aa61758933e172269a7547ab83c157dc1">BiPDF::dim</a> &gt; &amp;ext, std::vector&lt; tk::real &gt; &amp;outpdf, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query extents and other metadata of bivariate PDF sample space.  <a href="#a61a0c52d1e78abd4c5c11fee96577183"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_p_d_f_writer.html#acb06a2b99c44a13e0c92c4843ea95eed">extents</a> (const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;pdf, const std::vector&lt; tk::real &gt; &amp;uext, std::size_t &amp;nbix, std::size_t &amp;nbiy, std::size_t &amp;nbiz, tk::real &amp;xmin, tk::real &amp;xmax, tk::real &amp;ymin, tk::real &amp;ymax, tk::real &amp;zmin, tk::real &amp;zmax, std::array&lt; tk::real, <a class="el" href="classtk_1_1_tri_p_d_f.html#ad5a364bf2938a6622796be37b044d55e">TriPDF::dim</a> &gt; &amp;binsize, std::array&lt; long, 2 *<a class="el" href="classtk_1_1_tri_p_d_f.html#ad5a364bf2938a6622796be37b044d55e">TriPDF::dim</a> &gt; &amp;ext, std::vector&lt; tk::real &gt; &amp;outpdf, <a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a> centering) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query extents and other metadata of trivariate PDF sample space.  <a href="#acb06a2b99c44a13e0c92c4843ea95eed"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classtk_1_1_p_d_f_writer.html" title="PDFWriter : Writer.">PDFWriter</a> : <a class="el" href="classtk_1_1_writer.html">Writer</a>. </p>

<p>Definition at line <a class="el" href="_p_d_f_writer_8h_source.html#l00029">29</a> of file <a class="el" href="_p_d_f_writer_8h_source.html">PDFWriter.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad866a267ce43916618205da175312bba"></a><!-- doxytag: member="tk::PDFWriter::PDFWriter" ref="ad866a267ce43916618205da175312bba" args="(const std::string &amp;filename, tk::ctr::TxtFloatFormatType format=tk::ctr::TxtFloatFormatType::DEFAULT, kw::precision::info::expect::type precision=std::cout.precision())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1_p_d_f_writer.html#ad866a267ce43916618205da175312bba">PDFWriter::PDFWriter</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a270ba0ac9d911f0e874828015f82a28b">tk::ctr::TxtFloatFormatType</a>&#160;</td>
          <td class="paramname"><em>format</em> = <code>tk::ctr::TxtFloatFormatType::DEFAULT</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">kw::precision::info::expect::type&#160;</td>
          <td class="paramname"><em>precision</em> = <code>std::cout.precision()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Output filename to which output the PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">format</td><td>Configure floating-point output format for ASCII output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">precision</td><td>Configure precision for floating-point ASCII output </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00026">26</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_txt_float_format_8h_source.html#l00025">tk::ctr::DEFAULT</a>, <a class="el" href="_txt_float_format_8h_source.html#l00026">tk::ctr::FIXED</a>, <a class="el" href="_writer_8h_source.html#l00037">tk::Writer::m_outFile</a>, <a class="el" href="_txt_float_format_8h_source.html#l00027">tk::ctr::SCIENTIFIC</a>, and <a class="el" href="_exception_8h_source.html#l00034">Throw</a>.</p>
<div class="fragment"><pre class="fragment">                                                            :
  <a class="code" href="classtk_1_1_writer.html#aef3aa87f2664248c5c63887d4ab15436" title="Constructor: Acquire file handle. Protected: designed to be base only.">Writer</a>( filename )
<span class="comment">//******************************************************************************</span>
<span class="comment">//  Constructor</span><span class="comment"></span>
<span class="comment">//! \param[in] filename Output filename to which output the PDF</span>
<span class="comment">//! \param[in] format Configure floating-point output format for ASCII output</span>
<span class="comment">//! \param[in] precision Configure precision for floating-point ASCII output</span>
<span class="comment">//! \author J. Bakosi</span>
<span class="comment"></span><span class="comment">//******************************************************************************</span>
{
  <span class="comment">// Set floating-point format for output file stream</span>
  <span class="keywordflow">if</span> (format == <a class="code" href="namespacetk_1_1ctr.html#a270ba0ac9d911f0e874828015f82a28ba0354933e3876c5e0de4a8b92969c9cff">ctr::TxtFloatFormatType::DEFAULT</a>)
    {} <span class="comment">//m_outFile &lt;&lt; std::defaultfloat;   GCC does not yet support this</span>
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="namespacetk_1_1ctr.html#a270ba0ac9d911f0e874828015f82a28ba244fda2b97545dea7ea0031bf2efb356">ctr::TxtFloatFormatType::FIXED</a>)
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; std::fixed;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="namespacetk_1_1ctr.html#a270ba0ac9d911f0e874828015f82a28ba51e7a2ea3bc2ac22159a3960884dfb17">ctr::TxtFloatFormatType::SCIENTIFIC</a>)
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; std::scientific;
  <span class="keywordflow">else</span> <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8" title="Throw macro that always throws an exception.">Throw</a>( <span class="stringliteral">&quot;Text floating-point format not recognized.&quot;</span> );

  <span class="comment">// Set numeric precision for output file stream if the input makes sense</span>
  <span class="keywordflow">if</span> (precision &gt; 0 &amp;&amp; precision &lt; std::numeric_limits&lt; tk::real &gt;::digits10+2)
    m_outFile &lt;&lt; std::setprecision( static_cast&lt;int&gt;(precision) );
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a6685648a5b3e5bf52ecde7cff310c476"></a><!-- doxytag: member="tk::PDFWriter::assertSampleSpaceDimensions" ref="a6685648a5b3e5bf52ecde7cff310c476" args="(const Container &amp;c) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;std::size_t size, class Container &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a6685648a5b3e5bf52ecde7cff310c476">tk::PDFWriter::assertSampleSpaceDimensions</a> </td>
          <td>(</td>
          <td class="paramtype">const Container &amp;&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assert the number of sample space dimensions given. </p>

<p>Definition at line <a class="el" href="_p_d_f_writer_8h_source.html#l00074">74</a> of file <a class="el" href="_p_d_f_writer_8h_source.html">PDFWriter.h</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>.</p>
<div class="fragment"><pre class="fragment">                                                                 {
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( c.size() == size,
              <span class="stringliteral">&quot;Number of sample space variables must equal &quot;</span> +
              std::to_string( size ) + <span class="stringliteral">&quot; in PDF writer.&quot;</span> );
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a5aca398fbfa7c4e3c0104f7d7258fe6d"></a><!-- doxytag: member="tk::PDFWriter::assertSampleSpaceExtents" ref="a5aca398fbfa7c4e3c0104f7d7258fe6d" args="(const Container &amp;c) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;std::size_t size, class Container &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a5aca398fbfa7c4e3c0104f7d7258fe6d">tk::PDFWriter::assertSampleSpaceExtents</a> </td>
          <td>(</td>
          <td class="paramtype">const Container &amp;&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assert the number of sample space extents given. </p>

<p>Definition at line <a class="el" href="_p_d_f_writer_8h_source.html#l00082">82</a> of file <a class="el" href="_p_d_f_writer_8h_source.html">PDFWriter.h</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>.</p>
<div class="fragment"><pre class="fragment">                                                              {
      <span class="keywordflow">if</span> (!c.empty())
        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( c.size() == size*2,
                <span class="stringliteral">&quot;PDF user-specified sample space extents must be defined by &quot;</span> +
                std::to_string( size*2 ) +<span class="stringliteral">&quot; real numbers: minx, maxx, ...&quot;</span> );
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a7743163b6192e4767627137ba2463fe7"></a><!-- doxytag: member="tk::PDFWriter::createExFile" ref="a7743163b6192e4767627137ba2463fe7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtk_1_1_p_d_f_writer.html#a7743163b6192e4767627137ba2463fe7">PDFWriter::createExFile</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>ExodusII file handle </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l01102">1102</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, and <a class="el" href="_writer_8h_source.html#l00036">tk::Writer::m_filename</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> cpuwordsize = <span class="keyword">sizeof</span>( double );
  <span class="keywordtype">int</span> iowordsize = <span class="keyword">sizeof</span>( double );
  <span class="keywordtype">int</span> outFileId = ex_create( <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a>.c_str(),
                             EX_CLOBBER | EX_NORMAL_MODEL,
                             &amp;cpuwordsize,
                             &amp;iowordsize );
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( outFileId &gt; 0, <span class="stringliteral">&quot;Failed to create file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  <span class="keywordflow">return</span> outFileId;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a58e74d6f045704bd1f9c6698e6a779ae"></a><!-- doxytag: member="tk::PDFWriter::extents" ref="a58e74d6f045704bd1f9c6698e6a779ae" args="(const UniPDF &amp;pdf, const std::vector&lt; tk::real &gt; &amp;uext, std::size_t &amp;nbi, tk::real &amp;min, tk::real &amp;max, tk::real &amp;binsize, std::array&lt; long, 2 *UniPDF::dim &gt; &amp;ext, std::vector&lt; tk::real &gt; &amp;outpdf) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae">PDFWriter::extents</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_uni_p_d_f.html">UniPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>uext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>nbi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>binsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; long, 2 *<a class="el" href="classtk_1_1_uni_p_d_f.html#a8b2515fa9239e8b634a803db1935b25f">UniPDF::dim</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>outpdf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Query extents and other metadata of univariate PDF sample space. </p>
<p>Query and optionally override number of bins and minimum of sample space if user-specified extents were given and copy probabilities from pdf to an array for output for plotting univariate PDF. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Univariate PDF object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uext</td><td>User-specified extents of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>nbi Number of bins </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>min Minimum value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>max Maximum value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>binsize Bin size </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ext Extents of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>outpdf PDF ready to be written out to file </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l01174">1174</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>.</p>
<div class="fragment"><pre class="fragment">{
  assertSampleSpaceExtents&lt; 1 &gt;( uext );

  <span class="comment">// Query bin size and extents of sample space from PDF</span>
  binsize = <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.binsize();
  ext = <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.extents();

  <span class="comment">// Compute number of bins of sample space (min bins: 1)</span>
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( ext[1] &gt;= ext[0], <span class="stringliteral">&quot;Wrong extents in PDFWriter::extents&quot;</span> );
  nbi = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( ext[1] - ext[0] + 1 );

  <span class="comment">// Compute minimum and maximum of sample space</span>
  min = binsize * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[0] );
  max = binsize * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[1] );

  <span class="comment">// Override number of bins and minimum if user-specified extents were given,</span>
  <span class="comment">// and copy probabilities from pdf to an array for output</span>
  <span class="keywordflow">if</span> (!uext.empty()) {
    <span class="comment">// Override number of bins by that based on user-specified extents</span>
    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( uext[1] &gt;= uext[0],
            <span class="stringliteral">&quot;Wrong user-defined extents in PDFWriter::extents&quot;</span> );
    nbi = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>(
            std::lround( (uext[1] - uext[0]) / binsize ) );
    <span class="comment">// Override extents</span>
    min = uext[0];
    max = uext[1];

    <span class="comment">// Size output pdf to user-requested dimensions to overridden nbi and</span>
    <span class="comment">// initialize output probabilities to zero</span>
    outpdf = std::vector&lt; tk::real &gt;( nbi, 0.0 );

    <span class="comment">// Fill requested region of pdf to be output from computed pdf</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="comment">// Compute (i.e., shift) bin indices relative to user-requested extents</span>
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = p.first - std::lround( uext[0] / binsize );
      <span class="comment">// Only copy probability value if shifted bin indices fall within</span>
      <span class="comment">// user-requested extents (lower inclusive, upper exclusive)</span>
      <span class="keywordflow">if</span> (bin &gt;= 0 &amp;&amp; bin &lt; std::lround( (uext[1] - uext[0]) / binsize )) {
        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbi, <span class="stringliteral">&quot;Bin overflow in user-specified-extent-based bin &quot;</span>
                           <span class="stringliteral">&quot;calculation of univariate PDF extents.&quot;</span> );
        <span class="comment">// Copy normalized probability to output pdf</span>
        outpdf[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] =
          p.second / binsize / static_cast&lt;tk::real&gt;(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
      }
    }
  }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a58e74d6f045704bd1f9c6698e6a779ae_cgraph.svg" width="304" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a61a0c52d1e78abd4c5c11fee96577183"></a><!-- doxytag: member="tk::PDFWriter::extents" ref="a61a0c52d1e78abd4c5c11fee96577183" args="(const BiPDF &amp;pdf, const std::vector&lt; tk::real &gt; &amp;uext, std::size_t &amp;nbix, std::size_t &amp;nbiy, tk::real &amp;xmin, tk::real &amp;xmax, tk::real &amp;ymin, tk::real &amp;ymax, std::array&lt; tk::real, BiPDF::dim &gt; &amp;binsize, std::array&lt; long, 2 *BiPDF::dim &gt; &amp;ext, std::vector&lt; tk::real &gt; &amp;outpdf, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae">PDFWriter::extents</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>uext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>nbix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>nbiy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>ymin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>ymax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; tk::real, <a class="el" href="classtk_1_1_bi_p_d_f.html#aa61758933e172269a7547ab83c157dc1">BiPDF::dim</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>binsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; long, 2 *<a class="el" href="classtk_1_1_bi_p_d_f.html#aa61758933e172269a7547ab83c157dc1">BiPDF::dim</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>outpdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Query extents and other metadata of bivariate PDF sample space. </p>
<p>Query and optionally override number of bins and minima of sample space if user-specified extents were given and copy probabilities from pdf to a logically 2D array for output for plotting bivariate joint PDF. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Bivariate PDF object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uext</td><td>User-specified extents of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>nbix Number of bins in x dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>nbiy Number of bins in y dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>xmin Minimum x value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>xmax Maximum x value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ymin Minimum y value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ymax Maximum y value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>binsize Bin size </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ext Extents of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>outpdf PDF ready to be written out to file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l01246">1246</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>.</p>
<div class="fragment"><pre class="fragment">{
  assertSampleSpaceExtents&lt; 2 &gt;( uext );

  <span class="comment">// Query bin sizes and extents of sample space from PDF</span>
  binsize = <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.binsize();
  ext = <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.extents();

  <span class="comment">// Compute number of bins in sample space directions (min bins: 1)</span>
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( ext[1] &gt;= ext[0], <span class="stringliteral">&quot;Wrong extents in PDFWriter::extents&quot;</span> );
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( ext[3] &gt;= ext[2], <span class="stringliteral">&quot;Wrong extents in PDFWriter::extents&quot;</span> );
  nbix = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( ext[1] - ext[0] + 1 );
  nbiy = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( ext[3] - ext[2] + 1 );

  <span class="comment">// Compute minima and maxima of sample space</span>
  xmin = binsize[0] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[0] );
  xmax = binsize[0] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[1] );
  ymin = binsize[1] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[2] );
  ymax = binsize[1] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[3] );

  <span class="comment">// Override number of bins and minima if user-specified extents were given,</span>
  <span class="comment">// and copy probabilities from pdf to a logically 2D array for output</span>
  <span class="keywordflow">if</span> (!uext.empty()) {
    <span class="comment">// Override number of bins by that based on user-specified extents</span>
    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( uext[1] &gt;= uext[0],
            <span class="stringliteral">&quot;Wrong user-defined extents in PDFWriter::extents&quot;</span> );
    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( uext[3] &gt;= uext[2],
            <span class="stringliteral">&quot;Wrong user-defined extents in PDFWriter::extents&quot;</span> );
    nbix = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>(
             std::lround( (uext[1] - uext[0]) / binsize[0] ) );
    nbiy = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>(
             std::lround( (uext[3] - uext[2]) / binsize[1] ) );
    <span class="comment">// Override extents</span>
    xmin = uext[0];
    xmax = uext[1];
    ymin = uext[2];
    ymax = uext[3];

    <span class="comment">// Temporarily increase number of bins if node-centered output required</span>
    <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) { ++nbix; ++nbiy; }

    <span class="comment">// Size output pdf to user-requested dimensions to overridden nbiy * nbix</span>
    <span class="comment">// and initialize output probabilities to zero</span>
    outpdf = std::vector&lt; tk::real &gt;( nbix*nbiy, 0.0 );

    <span class="comment">// Fill requested region of pdf to be output from computed pdf</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="comment">// Compute (i.e., shift) bin indices relative to user-requested extents</span>
      <span class="keyword">const</span> <span class="keyword">auto</span> x = p.first[0] - std::lround( uext[0] / binsize[0] );
      <span class="keyword">const</span> <span class="keyword">auto</span> y = p.first[1] - std::lround( uext[2] / binsize[1] );
      <span class="comment">// Only copy probability value if shifted bin indices fall within</span>
      <span class="comment">// user-requested extents (lower inclusive, upper exclusive)</span>
      <span class="keywordflow">if</span> (x &gt;= 0 &amp;&amp; x &lt; std::lround( (uext[1] - uext[0]) / binsize[0] ) &amp;&amp;
          y &gt;= 0 &amp;&amp; y &lt; std::lround( (uext[3] - uext[2]) / binsize[1] ))
      {
        <span class="keyword">const</span> <span class="keyword">auto</span> bin =
          <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(y)*nbix + static_cast&lt;std::size_t&gt;(x);
        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy, <span class="stringliteral">&quot;Bin overflow in user-specified-extent-based &quot;</span>
                <span class="stringliteral">&quot;bin calculation of bivariate PDF.&quot;</span> );
        <span class="comment">// Copy normalized probability to output pdf</span>
        outpdf[ bin ] = p.second / binsize[0] / binsize[1]
                                 / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
      }
    }

    <span class="comment">// Revert number of bins if node-centered output required</span>
    <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) { --nbix; --nbiy; }
  }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a61a0c52d1e78abd4c5c11fee96577183_cgraph.svg" width="304" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acb06a2b99c44a13e0c92c4843ea95eed"></a><!-- doxytag: member="tk::PDFWriter::extents" ref="acb06a2b99c44a13e0c92c4843ea95eed" args="(const TriPDF &amp;pdf, const std::vector&lt; tk::real &gt; &amp;uext, std::size_t &amp;nbix, std::size_t &amp;nbiy, std::size_t &amp;nbiz, tk::real &amp;xmin, tk::real &amp;xmax, tk::real &amp;ymin, tk::real &amp;ymax, tk::real &amp;zmin, tk::real &amp;zmax, std::array&lt; tk::real, TriPDF::dim &gt; &amp;binsize, std::array&lt; long, 2 *TriPDF::dim &gt; &amp;ext, std::vector&lt; tk::real &gt; &amp;outpdf, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae">PDFWriter::extents</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>uext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>nbix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>nbiy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>nbiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>ymin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>ymax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>zmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::real &amp;&#160;</td>
          <td class="paramname"><em>zmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; tk::real, <a class="el" href="classtk_1_1_tri_p_d_f.html#ad5a364bf2938a6622796be37b044d55e">TriPDF::dim</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>binsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; long, 2 *<a class="el" href="classtk_1_1_tri_p_d_f.html#ad5a364bf2938a6622796be37b044d55e">TriPDF::dim</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>outpdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Query extents and other metadata of trivariate PDF sample space. </p>
<p>Query and optionally override number of bins and minima of sample space if user-specified extents were given and copy probabilities from pdf to a logically 3D array for output for plotting trivariate joint PDF. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Trivariate PDF object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uext</td><td>User-specified extents of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>nbix Number of bins in x dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>nbiy Number of bins in y dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>nbiz Number of bins in z dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>xmin Minimum x value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>xmax Maximum x value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ymin Minimum y value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ymax Maximum y value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>zmin Minimum z value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>zmax Maximum z value of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>binsize Bin size </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>ext Extents of sample space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inout]</td><td>outpdf PDF ready to be written out to file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l01347">1347</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>.</p>
<div class="fragment"><pre class="fragment">{
  assertSampleSpaceExtents&lt; 3 &gt;( uext );

  <span class="comment">// Query bin sizes and extents of sample space from PDF</span>
  binsize = <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.binsize();
  ext = <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.extents();

  <span class="comment">// Compute number of bins in sample space directions (min bins: 1)</span>
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( ext[1] &gt;= ext[0], <span class="stringliteral">&quot;Wrong extents in PDFWriter::extents&quot;</span> );
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( ext[3] &gt;= ext[2], <span class="stringliteral">&quot;Wrong extents in PDFWriter::extents&quot;</span> );
  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( ext[5] &gt;= ext[4], <span class="stringliteral">&quot;Wrong extents in PDFWriter::extents&quot;</span> );
  nbix = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( ext[1] - ext[0] + 1 );
  nbiy = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( ext[3] - ext[2] + 1 );
  nbiz = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( ext[5] - ext[4] + 1 );

  <span class="comment">// Compute minima and maxima of sample space</span>
  xmin = binsize[0] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[0] );
  xmax = binsize[0] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[1] );
  ymin = binsize[1] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[2] );
  ymax = binsize[1] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[3] );
  zmin = binsize[2] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[4] );
  zmax = binsize[2] * <span class="keyword">static_cast&lt;</span> tk::real <span class="keyword">&gt;</span>( ext[5] );

  <span class="comment">// Override number of bins and minima if user-specified extents were given,</span>
  <span class="comment">// and copy probabilities from pdf to a logically 3D array for output</span>
  <span class="keywordflow">if</span> (!uext.empty()) {
    <span class="comment">// Override number of bins by that based on user-specified extents</span>
    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( uext[1] &gt;= uext[0],
            <span class="stringliteral">&quot;Wrong user-defined extents in PDFWriter::extents&quot;</span> );
    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( uext[3] &gt;= uext[2],
            <span class="stringliteral">&quot;Wrong user-defined extents in PDFWriter::extents&quot;</span> );
    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( uext[5] &gt;= uext[4],
            <span class="stringliteral">&quot;Wrong user-defined extents in PDFWriter::extents&quot;</span> );
    nbix = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>(
             std::lround( (uext[1] - uext[0]) / binsize[0] ) );
    nbiy = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>(
             std::lround( (uext[3] - uext[2]) / binsize[1] ) );
    nbiz = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>(
             std::lround( (uext[5] - uext[4]) / binsize[2] ) );
    <span class="comment">// Override extents</span>
    xmin = uext[0];
    xmax = uext[1];
    ymin = uext[2];
    ymax = uext[3];
    zmin = uext[4];
    zmax = uext[5];

    <span class="comment">// Temporarily increase number of bins if node-centered output required</span>
    <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) { ++nbix; ++nbiy; ++nbiz; }

    <span class="comment">// Size output pdf to user-requested dimensions to overridden nbiz * nbiy *</span>
    <span class="comment">// nbix and initialize output probabilities to zero</span>
    outpdf = std::vector&lt; tk::real &gt;( nbiz * nbiy * nbix, 0.0 );

    <span class="comment">// Fill requested region of pdf to be output from computed pdf</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="comment">// Compute (i.e., shift) bin indices relative to user-requested extents</span>
      <span class="keyword">const</span> <span class="keyword">auto</span> x = p.first[0] - std::lround( uext[0] / binsize[0] );
      <span class="keyword">const</span> <span class="keyword">auto</span> y = p.first[1] - std::lround( uext[2] / binsize[1] );
      <span class="keyword">const</span> <span class="keyword">auto</span> z = p.first[2] - std::lround( uext[4] / binsize[2] );
      <span class="comment">// Only copy probability value if shifted bin indices fall within</span>
      <span class="comment">// user-requested extents (lower inclusive, upper exclusive)</span>
      <span class="keywordflow">if</span> (x &gt;= 0 &amp;&amp; x &lt; std::lround( (uext[1] - uext[0]) / binsize[0] ) &amp;&amp;
          y &gt;= 0 &amp;&amp; y &lt; std::lround( (uext[3] - uext[2]) / binsize[1] ) &amp;&amp;
          z &gt;= 0 &amp;&amp; z &lt; std::lround( (uext[5] - uext[4]) / binsize[2] ))
      {
        <span class="keyword">const</span> <span class="keyword">auto</span> X = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( x );
        <span class="keyword">const</span> <span class="keyword">auto</span> Y = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( y );
        <span class="keyword">const</span> <span class="keyword">auto</span> Z = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( z );
        <span class="keyword">const</span> <span class="keyword">auto</span> bin = nbix*(Z*nbiy + Y) + X;
        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy*nbiz, <span class="stringliteral">&quot;Bin overflow in &quot;</span>
              <span class="stringliteral">&quot;user-specified-extent-based bin calculation of bivariate PDF.&quot;</span> );
        <span class="comment">// Copy normalized probability to output pdf</span>
        outpdf[ bin ] =
          p.second / binsize[0] / binsize[1] / binsize[2]
                   / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
      }
    }

    <span class="comment">// Revert number of bins if node-centered output required</span>
    <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) { --nbix; --nbiy; --nbiz; }
  }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_acb06a2b99c44a13e0c92c4843ea95eed_cgraph.svg" width="304" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a30df2472b4cb140d9231bbbb28a0679e"></a><!-- doxytag: member="tk::PDFWriter::writeExHdr" ref="a30df2472b4cb140d9231bbbb28a0679e" args="(int outFileId, int nnode, int nelem) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a30df2472b4cb140d9231bbbb28a0679e">PDFWriter::writeExHdr</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outFileId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">outFileId</td><td>Output file ExodusII Id </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnode</td><td>Number of nodes in mesh to write </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nelem</td><td>Number of elements in mesh to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l01120">1120</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_init( outFileId,
                       <span class="stringliteral">&quot;Written by Quinoa&quot;</span>,
                       3,                     <span class="comment">// number of dimensions</span>
                       nnode,                 <span class="comment">// number of nodes</span>
                       nelem,                 <span class="comment">// number of elements</span>
                       1,                     <span class="comment">// number of element blocks</span>
                       0,                     <span class="comment">// number of node sets</span>
                       0 ) == 0,              <span class="comment">// number of side sets</span>
          <span class="stringliteral">&quot;Failed to write header to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6af1046645c630f1f169b9c99a82250e"></a><!-- doxytag: member="tk::PDFWriter::writeExodusII" ref="a6af1046645c630f1f169b9c99a82250e" args="(const BiPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info, std::size_t it, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a6af1046645c630f1f169b9c99a82250e">PDFWriter::writeExodusII</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write bivariate PDF to Exodus II file format. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Bivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">it</td><td>Iteration count </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00844">844</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>

<p>Referenced by <a class="el" href="_distributor_8_c_source.html#l00426">walker::Distributor::writeBiPDF()</a>, and <a class="el" href="_distributor_8_c_source.html#l00484">walker::Distributor::writeTriPDF()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 2 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 2 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 2D array for output</span>
  std::size_t nbix, nbiy;
  tk::real xmin, xmax, ymin, ymax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 2 &gt; binsize;
  std::array&lt; long, 2*BiPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, xmin, xmax, ymin, ymax, binsize, ext, outpdf,
           centering );

  <span class="comment">// Create ExodusII file</span>
  <span class="keywordtype">int</span> outFile = <a class="code" href="classtk_1_1_p_d_f_writer.html#a7743163b6192e4767627137ba2463fe7">createExFile</a>();

  <span class="comment">// Compute number of nodes and number of elements in sample space mesh</span>
  std::size_t nelem = nbix*nbiy;
  std::size_t nnode = (nbix+1)*(nbiy+1);

  <span class="comment">// Write ExodusII header</span>
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a30df2472b4cb140d9231bbbb28a0679e">writeExHdr</a>( outFile, static_cast&lt;int&gt;(nnode), static_cast&lt;int&gt;(nelem) );

  <span class="comment">// Write sample space variables as coordinate names</span>
  <span class="keywordtype">char</span>* coordnames[] = { <span class="keyword">const_cast&lt;</span> <span class="keywordtype">char</span>* <span class="keyword">&gt;</span>( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0].c_str() ),
                         const_cast&lt; char* &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1].c_str() ),
                         const_cast&lt; char* &gt;( <span class="stringliteral">&quot;probability&quot;</span> ) };
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_coord_names( outFile, coordnames ) == 0,
          <span class="stringliteral">&quot;Failed to write coordinate names to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output grid points of discretized sample space (2D Cartesian grid)</span>
  std::vector&lt; tk::real &gt; x( nnode, 0.0 );
  std::vector&lt; tk::real &gt; y( nnode, 0.0 );
  std::vector&lt; tk::real &gt; z( nnode, 0.0 );
  std::size_t k = 0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=nbiy; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=nbix; j++) {
      x[k] = xmin + j*binsize[0];
      y[k] = ymin + i*binsize[1];
      ++k;
    }
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_coord( outFile, x.data(), y.data(), z.data() ) == 0,
          <span class="stringliteral">&quot;Failed to write coordinates to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output elements of discretized sample space (2D Cartesian grid)</span>
  <span class="comment">// Write element block information</span>
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_elem_block( outFile,
                             1,
                             <span class="stringliteral">&quot;QUADRANGLES&quot;</span>,
                             static_cast&lt;int64_t&gt;(nelem),
                             4,
                             0 ) == 0,
          <span class="stringliteral">&quot;Failed to write QUDARANGLE element block to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  <span class="comment">// Write element connectivity</span>
  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;nelem; ++i) {
    <span class="keyword">auto</span> y = i/nbix;
    <span class="keywordtype">int</span> con[4] = { <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+1 ),
                   static_cast&lt; int &gt;( i+y+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+nbix+3 ),
                   static_cast&lt; int &gt;( i+y+nbix+2 ) };
    <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>(
      ne_put_n_elem_conn( outFile, 1, static_cast&lt;int64_t&gt;(i+1), 1, con ) == 0,
      <span class="stringliteral">&quot;Failed to write element connectivity to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  }

  <span class="comment">// Output PDF function values in element or node centers</span>
  <span class="keywordtype">char</span> c = <span class="charliteral">&#39;e&#39;</span>;
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) {
    ++nbix; ++nbiy;
    c = <span class="charliteral">&#39;n&#39;</span>;
  }

  <span class="comment">// Write PDF function values metadata</span>
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_var_param( outFile, &amp;c, 1 ) == 0,
            <span class="stringliteral">&quot;Failed to write results metadata to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  <span class="keywordtype">char</span>* probname[] = { <span class="keyword">const_cast&lt;</span> <span class="keywordtype">char</span>* <span class="keyword">&gt;</span>(
                       (name + <span class="charliteral">&#39;(&#39;</span> + <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] + <span class="charliteral">&#39;,&#39;</span> + <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] + <span class="charliteral">&#39;)&#39;</span>).c_str() ) };
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_var_names( outFile, &amp;c, 1, probname ) == 0,
            <span class="stringliteral">&quot;Failed to write results metadata to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {

    <span class="comment">// Output PDF function values in element centers</span>
    std::vector&lt; tk::real &gt; prob( nbix*nbiy, 0.0 );
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = (p.first[1] - ext[2]) * static_cast&lt;long&gt;(nbix) +
                       (p.first[0] - ext[0]) % static_cast&lt;long&gt;(nbix);
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &gt;= 0, <span class="stringliteral">&quot;Bin underflow in PDFWriter::writeExodusII().&quot;</span> );
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy, <span class="stringliteral">&quot;Bin overflow in PDFWriter::writeExodusII().&quot;</span> );
      prob[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] =
        p.second / binsize[0] / binsize[1]
                 / static_cast&lt;tk::real&gt;(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
    }
    <a class="code" href="classtk_1_1_p_d_f_writer.html#a7be8c9494b06b799f81b0a249567da3f">writeExVar</a>( outFile, it+1, centering, prob );

  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>

    <a class="code" href="classtk_1_1_p_d_f_writer.html#a7be8c9494b06b799f81b0a249567da3f">writeExVar</a>( outFile, it+1, centering, outpdf );

  }

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_close(outFile) == 0, <span class="stringliteral">&quot;Failed to close file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a6af1046645c630f1f169b9c99a82250e_cgraph.svg" width="344" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0d07cbcd15d3a6d40c27cc5438e7af42"></a><!-- doxytag: member="tk::PDFWriter::writeExodusII" ref="a0d07cbcd15d3a6d40c27cc5438e7af42" args="(const TriPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info, std::size_t it, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a6af1046645c630f1f169b9c99a82250e">PDFWriter::writeExodusII</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write trivariate PDF to Exodus II file format. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Trivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">it</td><td>Iteration count </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00968">968</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 3 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 3 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 3D array for output</span>
  std::size_t nbix, nbiy, nbiz;
  tk::real xmin, xmax, ymin, ymax, zmin, zmax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 3 &gt; binsize;
  std::array&lt; long, 2*TriPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, nbiz, xmin, xmax, ymin, ymax, zmin, zmax,
           binsize, ext, outpdf, centering );

  <span class="comment">// Create ExodusII file</span>
  <span class="keywordtype">int</span> outFile = <a class="code" href="classtk_1_1_p_d_f_writer.html#a7743163b6192e4767627137ba2463fe7">createExFile</a>();

  <span class="comment">// Compute number of nodes and number of elements in sample space mesh</span>
  std::size_t nelem = nbix*nbiy*nbiz;
  std::size_t nnode = (nbix+1)*(nbiy+1)*(nbiz+1);

  <span class="comment">// Write ExodusII header</span>
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a30df2472b4cb140d9231bbbb28a0679e">writeExHdr</a>( outFile, static_cast&lt;int&gt;(nnode), static_cast&lt;int&gt;(nelem) );

  <span class="comment">// Write sample space variables as coordinate names</span>
  <span class="keywordtype">char</span>* coordnames[] = { <span class="keyword">const_cast&lt;</span> <span class="keywordtype">char</span>* <span class="keyword">&gt;</span>( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0].c_str() ),
                         const_cast&lt; char* &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1].c_str() ),
                         const_cast&lt; char* &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[2].c_str() ) };
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_coord_names( outFile, coordnames ) == 0,
          <span class="stringliteral">&quot;Failed to write coordinate names to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output grid points of discretized sample space (2D Cartesian grid)</span>
  std::vector&lt; tk::real &gt; x( nnode, 0.0 );
  std::vector&lt; tk::real &gt; y( nnode, 0.0 );
  std::vector&lt; tk::real &gt; z( nnode, 0.0 );
  std::size_t l=0;
  <span class="keywordflow">for</span> (std::size_t k=0; k&lt;=nbiz; k++)
    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;=nbiy; i++)
      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;=nbix; j++) {
        x[l] = xmin + <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(j) * binsize[0];
        y[l] = ymin + <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(i) * binsize[1];
        z[l] = zmin + <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(k) * binsize[2];
        ++l;
      }
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_coord( outFile, x.data(), y.data(), z.data() ) == 0,
          <span class="stringliteral">&quot;Failed to write coordinates to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output elements of discretized sample space (2D Cartesian grid)</span>
  <span class="comment">// Write element block information</span>
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_elem_block( outFile,
                             1,
                             <span class="stringliteral">&quot;HEXAHEDRA&quot;</span>,
                             static_cast&lt;int64_t&gt;(nelem),
                             8,
                             0 ) == 0,
          <span class="stringliteral">&quot;Failed to write HEXAHEDRA element block to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  <span class="comment">// Write element connectivity</span>
  <span class="keyword">const</span> <span class="keyword">auto</span> n = nbix*nbiy;
  <span class="keyword">const</span> <span class="keyword">auto</span> p = (nbix+1)*(nbiy+1);
  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;nelem; ++i) {
    <span class="keyword">const</span> <span class="keyword">auto</span> y = i/nbix + i/n*(nbix+1);
    <span class="keywordtype">int</span> con[8] = { <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+1 ),
                   static_cast&lt; int &gt;( i+y+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+nbix+3 ),
                   static_cast&lt; int &gt;( i+y+nbix+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+p+1 ),
                   static_cast&lt; int &gt;( i+y+p+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+p+nbix+3 ),
                   static_cast&lt; int &gt;( i+y+p+nbix+2 ) };
    <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>(
      ne_put_n_elem_conn( outFile, 1, static_cast&lt;int64_t&gt;(i+1), 1, con ) == 0,
      <span class="stringliteral">&quot;Failed to write element connectivity to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  }

  <span class="comment">// Output PDF function values in element or node centers</span>
  <span class="keywordtype">char</span> c = <span class="charliteral">&#39;e&#39;</span>;
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) {
    ++nbix; ++nbiy; ++nbiz;
    c = <span class="charliteral">&#39;n&#39;</span>;
  }

  <span class="comment">// Write PDF function values metadata</span>
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_var_param( outFile, &amp;c, 1 ) == 0,
            <span class="stringliteral">&quot;Failed to write results metadata to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  <span class="keywordtype">char</span>* probname[] = { <span class="keyword">const_cast&lt;</span> <span class="keywordtype">char</span>* <span class="keyword">&gt;</span>( (name + <span class="charliteral">&#39;(&#39;</span> + <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] + <span class="charliteral">&#39;,&#39;</span> +
                         <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] + <span class="charliteral">&#39;,&#39;</span> + <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[2] + <span class="charliteral">&#39;)&#39;</span>).c_str() ) };
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_var_names( outFile, &amp;c, 1, probname ) == 0,
            <span class="stringliteral">&quot;Failed to write results metadata to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {

    <span class="comment">// Output PDF function values in element centers</span>
    std::vector&lt; tk::real &gt; prob( nbix*nbiy*nbiz, 0.0 );
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = (p.first[2] - ext[4]) * static_cast&lt;long&gt;(nbix*nbiy) +
                       (p.first[1] - ext[2]) * static_cast&lt;long&gt;(nbix) +
                       (p.first[0] - ext[0]) % static_cast&lt;long&gt;(nbix);
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &gt;= 0, <span class="stringliteral">&quot;Bin underflow in PDFWriter::writeExodusII().&quot;</span> );
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy*nbiz,
              <span class="stringliteral">&quot;Bin overflow in PDFWriter::writeExodusII().&quot;</span> );
      prob[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] =
        p.second / binsize[0] / binsize[1] / binsize[2]
                 / static_cast&lt;tk::real&gt;(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
    }
    <a class="code" href="classtk_1_1_p_d_f_writer.html#a7be8c9494b06b799f81b0a249567da3f">writeExVar</a>( outFile, it+1, centering, prob );

  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>

    <a class="code" href="classtk_1_1_p_d_f_writer.html#a7be8c9494b06b799f81b0a249567da3f">writeExVar</a>( outFile, it+1, centering, outpdf );

  }

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_close(outFile) == 0, <span class="stringliteral">&quot;Failed to close file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a0d07cbcd15d3a6d40c27cc5438e7af42_cgraph.svg" width="344" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7be8c9494b06b799f81b0a249567da3f"></a><!-- doxytag: member="tk::PDFWriter::writeExVar" ref="a7be8c9494b06b799f81b0a249567da3f" args="(int exoFile, std::size_t it, ctr::PDFCenteringType centering, const std::vector&lt; tk::real &gt; &amp;probability) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a7be8c9494b06b799f81b0a249567da3f">PDFWriter::writeExVar</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exoFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; tk::real &gt; &amp;&#160;</td>
          <td class="paramname"><em>probability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">exoFile</td><td>ExodusII file handle to write to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">it</td><td>Iteration count </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Node-, or element-centering to use on sample space mesh </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">probability</td><td>Probabilities at each sample space location </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l01141">1141</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, and <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>)
    <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_nodal_var( exoFile,
                              1,
                              1,
                              static_cast&lt;int64_t&gt;(probability.size()),
                              probability.data() ) == 0,
            <span class="stringliteral">&quot;Failed to write node-centered bivariate PDF to file: &quot;</span> +
            <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
  <span class="keywordflow">else</span>
    <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( ex_put_elem_var( exoFile,
                             1,
                             1,
                             1,
                             static_cast&lt;int64_t&gt;(probability.size()),
                             probability.data() ) == 0,
            <span class="stringliteral">&quot;Failed to write elem-centered bivariate PDF to file: &quot;</span> +
            <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a739e93034fb1c506b1adbb7e57d771a4"></a><!-- doxytag: member="tk::PDFWriter::writeGmshBin" ref="a739e93034fb1c506b1adbb7e57d771a4" args="(const BiPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a739e93034fb1c506b1adbb7e57d771a4">PDFWriter::writeGmshBin</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write bivariate PDF to gmsh (binary) file format. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Bivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00548">548</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>

<p>Referenced by <a class="el" href="_distributor_8_c_source.html#l00426">walker::Distributor::writeBiPDF()</a>, and <a class="el" href="_distributor_8_c_source.html#l00484">walker::Distributor::writeTriPDF()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 2 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 2 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 2D array for output</span>
  std::size_t nbix, nbiy;
  tk::real xmin, xmax, ymin, ymax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 2 &gt; binsize;
  std::array&lt; long, 2*BiPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, xmin, xmax, ymin, ymax, binsize, ext, outpdf,
           centering );

  <span class="comment">// Output metadata. The #s are unnecessary, but vi will color it differently.</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Comments\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Joint bivariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: 64-bit binary\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin sizes: &quot;</span> &lt;&lt; binsize[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; binsize[1] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; ext[3] - ext[2] + 1 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbix &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; nbiy &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extents: [&quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; xmax
            &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span> &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; ymax &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;$EndComments\n&quot;</span>;

  <span class="comment">// Output mesh header: mesh version, file type, data size</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$MeshFormat\n2.2 1 8\n&quot;</span>;
  <span class="keywordtype">int</span> one = 1;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt;char*&gt;(&amp;one), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\n$EndMeshFormat\n&quot;</span>;
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output grid points of discretized sample space (2D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Nodes\n&quot;</span> &lt;&lt; (nbix+1)*(nbiy+1) &lt;&lt; std::endl;
  <span class="keywordtype">int</span> k = 0;
  tk::real z = 0.0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=nbiy; i++) {
    tk::real y = ymin + i*binsize[1];
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=nbix; j++) {
      tk::real x = xmin + j*binsize[0];
      ++k;
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;k ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;x ), <span class="keyword">sizeof</span>(tk::real) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;y ), <span class="keyword">sizeof</span>(tk::real) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;z ), <span class="keyword">sizeof</span>(tk::real) );
    }
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\n$EndNodes\n&quot;</span>;

  <span class="comment">// Output elements of discretized sample space (2D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Elements\n&quot;</span> &lt;&lt; nbix*nbiy &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
  <span class="keywordtype">int</span> type = 3;                 <span class="comment">// gmsh elem type: 4-node quadrangle</span>
  std::size_t n = nbix*nbiy;    <span class="comment">// number of elements in (this single) block</span>
  <span class="keywordtype">int</span> ntags = 2;                <span class="comment">// number of element tags</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;type ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;n ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;ntags ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n; ++i) {
    <span class="keyword">const</span> <span class="keyword">auto</span> y = i/nbix;
    <span class="keyword">auto</span> <span class="keywordtype">id</span> = i+1;
    <span class="keywordtype">int</span> tag[2] = { 1, 1 };
    <span class="keywordtype">int</span> con[4] = { <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+1 ),
                   static_cast&lt; int &gt;( i+y+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+nbix+3 ),
                   static_cast&lt; int &gt;( i+y+nbix+2 ) };
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;<span class="keywordtype">id</span> ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( tag ), 2*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( con ), 4*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\n$EndElements\n&quot;</span>;

  <span class="comment">// Output PDF function values in element or node centers</span>
  std::string c( <span class="stringliteral">&quot;Element&quot;</span> );
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) {
    ++nbix; ++nbiy;
    c = <span class="stringliteral">&quot;Node&quot;</span>;
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="charliteral">&#39;$&#39;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n1\n\&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot;\n1\n0.0\n3\n0\n1\n&quot;</span>
            &lt;&lt; nbix*nbiy &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {

    std::vector&lt; bool &gt; out( nbix*nbiy, <span class="keyword">false</span> ); <span class="comment">// indicate bins filled</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = (p.first[1] - ext[2]) * static_cast&lt;long&gt;(nbix) +
                       (p.first[0] - ext[0]) % static_cast&lt;long&gt;(nbix);
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &gt;= 0, <span class="stringliteral">&quot;Bin underflow in PDFWriter::writeGmshBin().&quot;</span> );
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy, <span class="stringliteral">&quot;Bin overflow in PDFWriter::writeGmshBin().&quot;</span> );
      out[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] = <span class="keyword">true</span>;
      <span class="keyword">auto</span> <span class="keywordtype">id</span> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(bin+1);
      tk::real prob = p.second / binsize[0] / binsize[1]
                               / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;<span class="keywordtype">id</span> ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;prob ), <span class="keyword">sizeof</span>(tk::real) );
    }
    <span class="comment">// Output bins nonexistent in PDF (gmsh sometimes fails to plot the exiting</span>
    <span class="comment">// bins if holes exist in the data, it also looks better as zero than holes)</span>
    tk::real prob = 0.0;
    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;out.size(); ++i)
      <span class="keywordflow">if</span> (!out[i]) {
        <span class="keyword">auto</span> <span class="keywordtype">id</span> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1);
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;<span class="keywordtype">id</span> ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;prob ), <span class="keyword">sizeof</span>(tk::real) );
      }

  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>

    <span class="keywordtype">int</span> bin = 0;
    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : outpdf) {
      ++bin;
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;bin ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;p ), <span class="keyword">sizeof</span>(tk::real) );
    }

  }

  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$End&quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n&quot;</span>;

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a739e93034fb1c506b1adbb7e57d771a4_cgraph.svg" width="347" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a37505b9d24c467fd6164a9203a719a92"></a><!-- doxytag: member="tk::PDFWriter::writeGmshBin" ref="a37505b9d24c467fd6164a9203a719a92" args="(const TriPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a739e93034fb1c506b1adbb7e57d771a4">PDFWriter::writeGmshBin</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write trivariate PDF to gmsh (binary) file format. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Trivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00690">690</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 3 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 3 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 3D array for output</span>
  std::size_t nbix, nbiy, nbiz;
  tk::real xmin, xmax, ymin, ymax, zmin, zmax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 3 &gt; binsize;
  std::array&lt; long, 2*TriPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, nbiz, xmin, xmax, ymin, ymax, zmin, zmax,
           binsize, ext, outpdf, centering );

  <span class="comment">// Output metadata. The #s are unnecessary, but vi will color it differently.</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Comments\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Joint trivariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: 64-bit binary\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin sizes: &quot;</span> &lt;&lt; binsize[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; binsize[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>
            &lt;&lt; binsize[2] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; ext[3] - ext[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ext[5] - ext[4] + 1 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbix &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; nbiy &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; nbiz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extents: [&quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; xmax &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span>
            &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; ymax &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span> &lt;&lt; zmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; zmax &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;$EndComments\n&quot;</span>;

  <span class="comment">// Output mesh header: mesh version, file type, data size</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$MeshFormat\n2.2 1 8\n&quot;</span>;
  <span class="keywordtype">int</span> one = 1;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt;char*&gt;(&amp;one), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\n$EndMeshFormat\n&quot;</span>;
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output grid points of discretized sample space (3D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Nodes\n&quot;</span> &lt;&lt; (nbix+1)*(nbiy+1)*(nbiz+1) &lt;&lt; std::endl;
  <span class="keywordtype">int</span> l=0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=nbiz; k++) {
    tk::real z = zmin + k*binsize[2];
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=nbiy; j++) {
      tk::real y = ymin + j*binsize[1];
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=nbix; i++) {
        tk::real x = xmin + i*binsize[0];
        ++l;
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;l ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;x ), <span class="keyword">sizeof</span>(tk::real) );
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;y ), <span class="keyword">sizeof</span>(tk::real) );
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;z ), <span class="keyword">sizeof</span>(tk::real) );
      }
    }
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\n$EndNodes\n&quot;</span>;

  <span class="comment">// Output elements of discretized sample space (3D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Elements\n&quot;</span> &lt;&lt; nbix*nbiy*nbiz &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
  <span class="keywordtype">int</span> type = 5;                       <span class="comment">// gmsh elem type: 8-node hexahedron</span>
  std::size_t nelem = nbix*nbiy*nbiz; <span class="comment">// num of elements in (this single) block</span>
  <span class="keywordtype">int</span> ntags = 2;                      <span class="comment">// number of element tags</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;type ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;nelem ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;ntags ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  <span class="keyword">const</span> <span class="keyword">auto</span> n = nbix*nbiy;
  <span class="keyword">const</span> <span class="keyword">auto</span> p = (nbix+1)*(nbiy+1);
  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;nelem; ++i) {
    <span class="keyword">const</span> <span class="keyword">auto</span> y = i/nbix + i/n*(nbix+1);
    <span class="keyword">auto</span> <span class="keywordtype">id</span> = i+1;
    <span class="keywordtype">int</span> tag[2] = { 1, 1 };
    <span class="keywordtype">int</span> con[8] = { <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+1 ),
                   static_cast&lt; int &gt;( i+y+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+nbix+3 ),
                   static_cast&lt; int &gt;( i+y+nbix+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+p+1 ),
                   static_cast&lt; int &gt;( i+y+p+2 ),
                   <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( i+y+p+nbix+3 ),
                   static_cast&lt; int &gt;( i+y+p+nbix+2 ) };
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;<span class="keywordtype">id</span> ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( tag ), 2*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( con ), 8*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\n$EndElements\n&quot;</span>;

  <span class="comment">// Output PDF function values in element or node centers</span>
  std::string c( <span class="stringliteral">&quot;Element&quot;</span> );
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) {
    ++nbix; ++nbiy; ++nbiz;
    c = <span class="stringliteral">&quot;Node&quot;</span>;
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="charliteral">&#39;$&#39;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n1\n\&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot;\n1\n0.0\n3\n0\n1\n&quot;</span>
            &lt;&lt; nbix*nbiy*nbiz &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {

    std::vector&lt; bool &gt; out( nbix*nbiy*nbiz, <span class="keyword">false</span> ); <span class="comment">// indicate bins filled</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = (p.first[2] - ext[4]) * static_cast&lt;long&gt;(nbix*nbiy) +
                       (p.first[1] - ext[2]) * static_cast&lt;long&gt;(nbix) +
                       (p.first[0] - ext[0]) % static_cast&lt;long&gt;(nbix);
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &gt;= 0, <span class="stringliteral">&quot;Bin underflow in PDFWriter::writeGmshBin().&quot;</span> );
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy*nbiz,
              <span class="stringliteral">&quot;Bin overflow in PDFWriter::writeGmshBin().&quot;</span> );
      out[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] = <span class="keyword">true</span>;
      <span class="keyword">auto</span> <span class="keywordtype">id</span> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(bin+1);
      tk::real prob = p.second / binsize[0] / binsize[1] / binsize[2]
                               / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample());
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;<span class="keywordtype">id</span> ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;prob ), <span class="keyword">sizeof</span>(tk::real) );
    }
    <span class="comment">// Output bins nonexistent in PDF (gmsh sometimes fails to plot the exiting</span>
    <span class="comment">// bins if holes exist in the data, it also looks better as zero than holes)</span>
    tk::real prob = 0.0;
    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;out.size(); ++i)
      <span class="keywordflow">if</span> (!out[i]) {
        <span class="keyword">auto</span> <span class="keywordtype">id</span> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1);
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;<span class="keywordtype">id</span> ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;prob ), <span class="keyword">sizeof</span>(tk::real) );
      }

  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>

    <span class="keywordtype">int</span> bin = 0;
    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : outpdf) {
      ++bin;
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;bin ), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.write( reinterpret_cast&lt; char* &gt;( &amp;p ), <span class="keyword">sizeof</span>(tk::real) );
    }

  }

  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$End&quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n&quot;</span>;

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a37505b9d24c467fd6164a9203a719a92_cgraph.svg" width="347" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a008d30e8fbef66672f922e507cebe481"></a><!-- doxytag: member="tk::PDFWriter::writeGmshTxt" ref="a008d30e8fbef66672f922e507cebe481" args="(const BiPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a008d30e8fbef66672f922e507cebe481">PDFWriter::writeGmshTxt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write bivariate PDF to gmsh (text) file format. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Bivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00314">314</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>

<p>Referenced by <a class="el" href="_distributor_8_c_source.html#l00426">walker::Distributor::writeBiPDF()</a>, and <a class="el" href="_distributor_8_c_source.html#l00484">walker::Distributor::writeTriPDF()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 2 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 2 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 2D array for output</span>
  std::size_t nbix, nbiy;
  tk::real xmin, xmax, ymin, ymax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 2 &gt; binsize;
  std::array&lt; long, 2*BiPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, xmin, xmax, ymin, ymax, binsize, ext, outpdf,
           centering );

  <span class="comment">// Output metadata. The #s are unnecessary, but vi will color it differently.</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Comments\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Joint bivariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: &quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.precision() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin sizes: &quot;</span> &lt;&lt; binsize[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; binsize[1] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; ext[3] - ext[2] + 1 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbix &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; nbiy &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extents: [&quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; xmax
            &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span> &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; ymax &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;$EndComments\n&quot;</span>;

  <span class="comment">// Output mesh header: mesh version, file type, data size</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$MeshFormat\n2.2 0 8\n$EndMeshFormat\n&quot;</span>;
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output grid points of discretized sample space (2D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Nodes\n&quot;</span> &lt;&lt; (nbix+1)*(nbiy+1) &lt;&lt; std::endl;
  <span class="keywordtype">int</span> k=0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=nbiy; i++) {
    tk::real y = ymin + i*binsize[1];
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=nbix; j++) {
      tk::real x = xmin + j*binsize[0];
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; ++k &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; x &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; 0\n&quot;</span>;
    }
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$EndNodes\n&quot;</span>;

  <span class="comment">// Output elements of discretized sample space (2D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Elements\n&quot;</span> &lt;&lt; nbix*nbiy &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;nbix*nbiy; ++i) {
    <span class="keyword">const</span> <span class="keyword">auto</span> y = i/nbix;
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; 3 2 1 1 &quot;</span> &lt;&lt; i+y+1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i+y+2 &lt;&lt; <span class="charliteral">&#39; &#39;</span>
              &lt;&lt; i+y+nbix+3 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i+y+nbix+2 &lt;&lt; std::endl;
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$EndElements\n&quot;</span>;

  <span class="comment">// Output PDF function values in element or node centers</span>
  std::string c( <span class="stringliteral">&quot;Element&quot;</span> );
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) {
    ++nbix; ++nbiy;
    c = <span class="stringliteral">&quot;Node&quot;</span>;
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="charliteral">&#39;$&#39;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n1\n\&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot;\n1\n0.0\n3\n0\n1\n&quot;</span>
            &lt;&lt; nbix*nbiy &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {

    std::vector&lt; bool &gt; out( nbix*nbiy, <span class="keyword">false</span> ); <span class="comment">// indicate bins filled</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = (p.first[1] - ext[2]) * static_cast&lt;long&gt;(nbix) +
                       (p.first[0] - ext[0]) % static_cast&lt;long&gt;(nbix);
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &gt;= 0, <span class="stringliteral">&quot;Bin underflow in PDFWriter::writeGmshTxt().&quot;</span> );
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy, <span class="stringliteral">&quot;Bin overflow in PDFWriter::writeGmshTxt().&quot;</span> );
      out[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] = <span class="keyword">true</span>;
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; bin+1 &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p.second / binsize[0] / binsize[1]
                            / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample())
                &lt;&lt; std::endl;
    }
    <span class="comment">// Output bins nonexistent in PDF (gmsh sometimes fails to plot the exiting</span>
    <span class="comment">// bins if holes exist in the data, it also looks better as zero than holes)</span>
    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;out.size(); ++i)
      <span class="keywordflow">if</span> (!out[i]) <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot;\t0&quot;</span> &lt;&lt; std::endl;

  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>

    std::size_t bin = 0;
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : outpdf) <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; ++bin &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; p &lt;&lt; std::endl;

  }

  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$End&quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n&quot;</span>;

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a008d30e8fbef66672f922e507cebe481_cgraph.svg" width="347" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af2a0728ea2308ddde703ba63abb72ffc"></a><!-- doxytag: member="tk::PDFWriter::writeGmshTxt" ref="af2a0728ea2308ddde703ba63abb72ffc" args="(const TriPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info, ctr::PDFCenteringType centering) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a008d30e8fbef66672f922e507cebe481">PDFWriter::writeGmshTxt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15">ctr::PDFCenteringType</a>&#160;</td>
          <td class="paramname"><em>centering</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write trivariate PDF to gmsh (text) file format. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Trivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centering</td><td>Bin centering on sample space mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00425">425</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_p_d_f_centering_8h_source.html#l00026">tk::ctr::NODE</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 3 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 3 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 3D array for output</span>
  std::size_t nbix, nbiy, nbiz;
  tk::real xmin, xmax, ymin, ymax, zmin, zmax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 3 &gt; binsize;
  std::array&lt; long, 2*TriPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, nbiz, xmin, xmax, ymin, ymax, zmin, zmax,
           binsize, ext, outpdf, centering );

  <span class="comment">// Output metadata. The #s are unnecessary, but vi will color it differently.</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Comments\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Joint trivariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: &quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.precision() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin sizes: &quot;</span> &lt;&lt; binsize[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; binsize[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>
            &lt;&lt; binsize[2] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; ext[3] - ext[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ext[5] - ext[4] + 1 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbix &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; nbiy &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; nbiz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extents: [&quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; xmax &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span>
            &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; ymax &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span> &lt;&lt; zmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; zmax &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;$EndComments\n&quot;</span>;

  <span class="comment">// Output mesh header: mesh version, file type, data size</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$MeshFormat\n2.2 0 8\n$EndMeshFormat\n&quot;</span>;
  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );

  <span class="comment">// Output grid points of discretized sample space (3D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Nodes\n&quot;</span> &lt;&lt; (nbix+1)*(nbiy+1)*(nbiz+1) &lt;&lt; std::endl;
  <span class="keywordtype">int</span> l=0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=nbiz; k++) {
    tk::real z = zmin + k*binsize[2];
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=nbiy; j++) {
      tk::real y = ymin + j*binsize[1];
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=nbix; i++) {
        tk::real x = xmin + i*binsize[0];
        <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; ++l &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; x &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; y &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; z &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
      }
    }
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$EndNodes\n&quot;</span>;

  <span class="comment">// Output elements of discretized sample space (3D Cartesian grid)</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$Elements\n&quot;</span> &lt;&lt; nbix*nbiy*nbiz &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
  <span class="keyword">const</span> <span class="keyword">auto</span> n = nbix*nbiy;
  <span class="keyword">const</span> <span class="keyword">auto</span> p = (nbix+1)*(nbiy+1);
  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;nbix*nbiy*nbiz; ++i) {
    <span class="keyword">const</span> <span class="keyword">auto</span> y = i/nbix + i/n*(nbix+1);
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; 5 2 1 1 &quot;</span> &lt;&lt; i+y+1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i+y+2 &lt;&lt; <span class="charliteral">&#39; &#39;</span>
              &lt;&lt; i+y+nbix+3 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i+y+nbix+2 &lt;&lt; <span class="charliteral">&#39; &#39;</span>
              &lt;&lt; i+y+p+1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i+y+p+2 &lt;&lt; <span class="charliteral">&#39; &#39;</span>
              &lt;&lt; i+y+p+nbix+3 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i+y+p+nbix+2 &lt;&lt; <span class="charliteral">&#39; &#39;</span>
              &lt;&lt; std::endl;
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$EndElements\n&quot;</span>;

  <span class="comment">// Output PDF function values in element or node centers</span>
  std::string c( <span class="stringliteral">&quot;Element&quot;</span> );
  <span class="keywordflow">if</span> (centering == <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15aa15bb289c418f4d0308eb5d9faec4eb2">ctr::PDFCenteringType::NODE</a>) {
    ++nbix; ++nbiy; ++nbiz;
    c = <span class="stringliteral">&quot;Node&quot;</span>;
  }
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="charliteral">&#39;$&#39;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n1\n\&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot;\n1\n0.0\n3\n0\n1\n&quot;</span>
            &lt;&lt; nbix*nbiy*nbiz &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {

    std::vector&lt; bool &gt; out( nbix*nbiy*nbiz, <span class="keyword">false</span> ); <span class="comment">// indicate bins filled</span>
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map()) {
      <span class="keyword">const</span> <span class="keyword">auto</span> bin = (p.first[2] - ext[4]) * static_cast&lt;long&gt;(nbix*nbiy) +
                       (p.first[1] - ext[2]) * static_cast&lt;long&gt;(nbix) +
                       (p.first[0] - ext[0]) % static_cast&lt;long&gt;(nbix);
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &gt;= 0, <span class="stringliteral">&quot;Bin underflow in PDFWriter::writeGmshTxt().&quot;</span> );
      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810" title="Assert macro that only throws an exception if expr fails.">Assert</a>( bin &lt; nbix*nbiy*nbiz,
              <span class="stringliteral">&quot;Bin overflow in PDFWriter::writeGmshTxt().&quot;</span> );
      out[ <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(bin) ] = <span class="keyword">true</span>;
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; bin+1 &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p.second / binsize[0] / binsize[1] / binsize[2]
                            / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample())
                &lt;&lt; std::endl;
    }
    <span class="comment">// Output bins nonexistent in PDF (gmsh sometimes fails to plot the exiting</span>
    <span class="comment">// bins if holes exist in the data, it also looks better as zero than holes)</span>
    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;out.size(); ++i)
      <span class="keywordflow">if</span> (!out[i]) <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot;\t0&quot;</span> &lt;&lt; std::endl;

  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>

    std::size_t bin = 0;
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : outpdf) <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; ++bin &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; p &lt;&lt; std::endl;

  }

  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;$End&quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;Data\n&quot;</span>;

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_af2a0728ea2308ddde703ba63abb72ffc_cgraph.svg" width="347" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1f798f74e0d815b8bc9e409fbc7da85c"></a><!-- doxytag: member="tk::PDFWriter::writeTxt" ref="a1f798f74e0d815b8bc9e409fbc7da85c" args="(const UniPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a1f798f74e0d815b8bc9e409fbc7da85c">PDFWriter::writeTxt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_uni_p_d_f.html">UniPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write univariate PDF to text file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Univariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00053">53</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>

<p>Referenced by <a class="el" href="_distributor_8_c_source.html#l00426">walker::Distributor::writeBiPDF()</a>, <a class="el" href="_distributor_8_c_source.html#l00484">walker::Distributor::writeTriPDF()</a>, and <a class="el" href="_distributor_8_c_source.html#l00388">walker::Distributor::writeUniPDF()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 1 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 1 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minimum of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to an</span>
  <span class="comment">// array for output</span>
  std::size_t nbi;
  tk::real min, max;
  std::vector&lt; tk::real &gt; outpdf;
  tk::real binsize;
  std::array&lt; long, 2*UniPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbi, min, max, binsize, ext, outpdf );

  <span class="comment">// Output header</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Univariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;)&#39;</span> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: &quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.precision() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin size: &quot;</span> &lt;&lt; binsize &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1
            &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbi &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extent: [&quot;</span> &lt;&lt; min &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; max &lt;&lt; <span class="stringliteral">&quot;]\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Example step-by-step visualization with gnuplot\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set grid\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; unset key\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set xlabel \&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set ylabel \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="stringliteral">&quot;)\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; plot &quot;</span>;
  <span class="keywordflow">if</span> (!uext.empty()) <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; uext[0] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[1] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; with points\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Gnuplot one-liner for quick copy-paste\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# set grid; unset key; set xlabel \&quot;&quot;</span> &lt;&lt; vars[0]
            &lt;&lt; <span class="stringliteral">&quot;\&quot;; set ylabel \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; vars[0]
            &lt;&lt; <span class="stringliteral">&quot;)\&quot;; plot&quot;</span>;
  <span class="keywordflow">if</span> (!uext.empty()) <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; uext[0] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[1] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot; \&quot;&quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; w p\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Data columns: &quot;</span> &lt;&lt; vars[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; vars[0]
            &lt;&lt; <span class="stringliteral">&quot;)\n# -----------------------------------------------\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map())
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; binsize * static_cast&lt;tk::real&gt;(p.first) &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(p.second) / binsize /
                   static_cast&lt;tk::real&gt;(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample())
                &lt;&lt; std::endl;
  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>
    std::size_t bin = 0;
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : outpdf)
      m_outFile &lt;&lt; binsize * static_cast&lt;tk::real&gt;(bin++) + uext[0] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p &lt;&lt; std::endl;
  }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a1f798f74e0d815b8bc9e409fbc7da85c_cgraph.svg" width="312" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a030e93d822be2adcfd0f43ee46505cbd"></a><!-- doxytag: member="tk::PDFWriter::writeTxt" ref="a030e93d822be2adcfd0f43ee46505cbd" args="(const BiPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a1f798f74e0d815b8bc9e409fbc7da85c">PDFWriter::writeTxt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_bi_p_d_f.html">BiPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write bivariate PDF to text file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Bivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00123">123</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_p_d_f_centering_8h_source.html#l00025">tk::ctr::ELEM</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 2 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 2 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 2D array for output</span>
  std::size_t nbix, nbiy;
  tk::real xmin, xmax, ymin, ymax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 2 &gt; binsize;
  std::array&lt; long, 2*BiPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, xmin, xmax, ymin, ymax, binsize, ext, outpdf,
           <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15a8184d7d989393ae3d20f936f08dff89b">ctr::PDFCenteringType::ELEM</a> );

  <span class="comment">// Output metadata</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Joint bivariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: &quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.precision() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin sizes: &quot;</span> &lt;&lt; binsize[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; binsize[1] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; ext[3] - ext[2] + 1 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbix &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; nbiy &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extents: [&quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; xmax
            &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span> &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; ymax &lt;&lt; <span class="stringliteral">&quot;]\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Example step-by-step visualization with gnuplot\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set grid\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; unset key\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set xlabel \&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set ylabel \&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set zlabel \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="stringliteral">&quot;)\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set dgrid3d 50,50,1\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set cntrparam levels 20\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set contour\n&quot;</span>;
  <span class="keywordflow">if</span> (!uext.empty())
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set xrange [&quot;</span> &lt;&lt; uext[0] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[1] &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
              &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set yrange [&quot;</span> &lt;&lt; uext[2] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[3] &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;
         
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; splot \&quot;&quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; with lines\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Gnuplot one-liner for quick copy-paste\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# --------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# set grid; unset key; set xlabel \&quot;&quot;</span> &lt;&lt; vars[0]
            &lt;&lt; <span class="stringliteral">&quot;\&quot;; set ylabel \&quot;&quot;</span> &lt;&lt; vars[1] &lt;&lt; <span class="stringliteral">&quot;\&quot;; set zlabel \&quot;&quot;</span> &lt;&lt; name
            &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; vars[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[1] &lt;&lt; <span class="stringliteral">&quot;)\&quot;; set dgrid3d 50,50,1; &quot;</span>
               <span class="stringliteral">&quot;set cntrparam levels 20; set contour; &quot;</span>;
  <span class="keywordflow">if</span> (!uext.empty())
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;set xrange [&quot;</span> &lt;&lt; uext[0] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[1] &lt;&lt; <span class="stringliteral">&quot;]; set yrange &quot;</span>
                 <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; uext[2] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[3] &lt;&lt; <span class="stringliteral">&quot;]; &quot;</span>;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;splot \&quot;&quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; w l\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Data columns: &quot;</span> &lt;&lt; vars[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; vars[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>
            &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; vars[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[1] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map())
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; binsize[0] * static_cast&lt;tk::real&gt;(p.first[0]) &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; binsize[1] * <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(p.first[1]) &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p.second / binsize[0] / binsize[1] /
                   static_cast&lt;tk::real&gt;(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample())
                &lt;&lt; std::endl;
  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>
    std::size_t bin = 0;
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : outpdf) {
      m_outFile &lt;&lt; binsize[0] * static_cast&lt;tk::real&gt;(bin % nbix) + uext[0]
                &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; binsize[1] * static_cast&lt;tk::real&gt;(bin / nbix) + uext[2]
                &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p
                &lt;&lt; std::endl;
      ++bin;
    }
  }

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a030e93d822be2adcfd0f43ee46505cbd_cgraph.svg" width="312" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a0572ffefffc20b60111327e220e3a6"></a><!-- doxytag: member="tk::PDFWriter::writeTxt" ref="a9a0572ffefffc20b60111327e220e3a6" args="(const TriPDF &amp;pdf, const tk::ctr::PDFInfo &amp;info) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtk_1_1_p_d_f_writer.html#a1f798f74e0d815b8bc9e409fbc7da85c">PDFWriter::writeTxt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_tri_p_d_f.html">TriPDF</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtk_1_1ctr_1_1_p_d_f_info.html">tk::ctr::PDFInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write trivariate PDF to text file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pdf</td><td>Trivariate PDF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>PDF metadata </td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_p_d_f_writer_8_c_source.html#l00216">216</a> of file <a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a>.</p>

<p>References <a class="el" href="_p_d_f_centering_8h_source.html#l00025">tk::ctr::ELEM</a>, <a class="el" href="_exception_8h_source.html#l00059">ErrChk</a>, <a class="el" href="_stat_ctr_8h_source.html#l00189">tk::ctr::pdf()</a>, and <a class="el" href="_stat_ctr_8h_source.html#l00275">tk::ctr::vars()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a01a3aaace501ce9affbf87938870da53" title="PDF identifier, i.e., name.">name</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; uext = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#abeecfd59b3001515a7fbccaf47fab00c" title="Sample space extents.">exts</a>;
  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> = info.<a class="code" href="structtk_1_1ctr_1_1_p_d_f_info.html#a453b86f1504fd0ce967560563a2324a9" title="List of sample space ariables.">vars</a>;

  assertSampleSpaceDimensions&lt; 3 &gt;( <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a> );
  assertSampleSpaceExtents&lt; 3 &gt;( uext );

  <span class="comment">// Query and optionally override number of bins and minima of sample space if</span>
  <span class="comment">// user-specified extents were given and copy probabilities from pdf to a</span>
  <span class="comment">// logically 3D array for output</span>
  std::size_t nbix, nbiy, nbiz;
  tk::real xmin, xmax, ymin, ymax, zmin, zmax;
  std::vector&lt; tk::real &gt; outpdf;
  std::array&lt; tk::real, 3 &gt; binsize;
  std::array&lt; long, 2*TriPDF::dim &gt; ext;
  <a class="code" href="classtk_1_1_p_d_f_writer.html#a58e74d6f045704bd1f9c6698e6a779ae" title="Query extents and other metadata of univariate PDF sample space.">extents</a>( <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>, uext, nbix, nbiy, nbiz, xmin, xmax, ymin, ymax, zmin, zmax,
           binsize, ext, outpdf, <a class="code" href="namespacetk_1_1ctr.html#a40a0ecd250d0cb2a6fe75ffe159ffc15a8184d7d989393ae3d20f936f08dff89b">ctr::PDFCenteringType::ELEM</a> );

  <span class="comment">// Output header</span>
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# vim: filetype=sh:\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Joint trivariate PDF: &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Numeric precision: &quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.precision() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Bin sizes: &quot;</span> &lt;&lt; binsize[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; binsize[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>
            &lt;&lt; binsize[2] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins estimated: &quot;</span> &lt;&lt; ext[1] - ext[0] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; ext[3] - ext[2] + 1 &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; ext[5] - ext[4] + 1 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Number of bins output: &quot;</span> &lt;&lt; nbix &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; nbiy &lt;&lt; <span class="stringliteral">&quot; x &quot;</span>
            &lt;&lt; nbiz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Sample space extents: [&quot;</span> &lt;&lt; xmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; xmax &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span>
            &lt;&lt; ymin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; ymax &lt;&lt; <span class="stringliteral">&quot;], [&quot;</span> &lt;&lt; zmin &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; zmax
            &lt;&lt; <span class="stringliteral">&quot;]\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Example step-by-step visualization with gnuplot\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set grid\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set xlabel \&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[0] &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set ylabel \&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[1] &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set zlabel \&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacetk_1_1ctr.html#aec7b1fae00e22c12dfa1112fb6c4324c" title="Find sample space variables for a PDF.">vars</a>[2] &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>;
  <span class="keywordflow">if</span> (!uext.empty())
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set xrange [&quot;</span> &lt;&lt; uext[0] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[1] &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
              &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set yrange [&quot;</span> &lt;&lt; uext[2] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[3] &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>
              &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; set zrange [&quot;</span> &lt;&lt; uext[4] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[5] &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;# gnuplot&gt; splot \&quot;&quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; pointtype 7 &quot;</span>
               <span class="stringliteral">&quot;linecolor palette title \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; vars[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span>
            &lt;&lt; vars[1] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[2] &lt;&lt; <span class="stringliteral">&quot;)\&quot;\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Gnuplot one-liner for quick copy-paste\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# --------------------------------------\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# set grid; set xlabel \&quot;&quot;</span> &lt;&lt; vars[0] &lt;&lt; <span class="stringliteral">&quot;\&quot;; set ylabel \&quot;&quot;</span>
            &lt;&lt; vars[1] &lt;&lt; <span class="stringliteral">&quot;\&quot;; set zlabel \&quot;&quot;</span> &lt;&lt; vars[2] &lt;&lt; <span class="stringliteral">&quot;\&quot;; &quot;</span>;
  <span class="keywordflow">if</span> (!uext.empty())
    <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;set xrange [&quot;</span> &lt;&lt; uext[0] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[1] &lt;&lt; <span class="stringliteral">&quot;]; set yrange &quot;</span>
                 <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; uext[2] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[3] &lt;&lt; <span class="stringliteral">&quot;]; set zrange [&quot;</span>
              &lt;&lt; uext[4] &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; uext[5] &lt;&lt; <span class="stringliteral">&quot;]; &quot;</span>;
  <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; <span class="stringliteral">&quot;splot \&quot;&quot;</span> &lt;&lt; <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; pt 7 linecolor palette title \&quot;&quot;</span>
            &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; vars[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[1] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[2] &lt;&lt; <span class="charliteral">&#39;)&#39;</span>
            &lt;&lt; <span class="stringliteral">&quot;\&quot;\n#\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# Data columns: &quot;</span> &lt;&lt; vars[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; vars[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>
            &lt;&lt; vars[2] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; vars[0] &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[1]
            &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; vars[2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;# -----------------------------------------------\n&quot;</span>;

  <span class="comment">// If no user-specified sample space extents, output pdf map directly</span>
  <span class="keywordflow">if</span> (uext.empty()) {
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.map())
      <a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a> &lt;&lt; binsize[0] * static_cast&lt;tk::real&gt;(p.first[0]) &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; binsize[1] * <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(p.first[1]) &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; binsize[2] * static_cast&lt;tk::real&gt;(p.first[2]) &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p.second / binsize[0] / binsize[1] / binsize[2]
                            / <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(<a class="code" href="namespacetk_1_1ctr.html#a1ae4f5b7ac9b69c29ce96ee87042e499" title="Function for writing PDF sample space variables to output streams.">pdf</a>.nsample())
                &lt;&lt; std::endl;
  } <span class="keywordflow">else</span> { <span class="comment">// If user-specified sample space extents, output outpdf array</span>
    std::size_t bin = 0;
    <span class="keyword">const</span> <span class="keyword">auto</span> n = nbix*nbiy;
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : outpdf) {
      m_outFile &lt;&lt; binsize[0] * static_cast&lt;tk::real&gt;(bin % n % nbix) + uext[0]
                &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; binsize[1] * static_cast&lt;tk::real&gt;(bin % n / nbix) + uext[2]
                &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; binsize[2] * <span class="keyword">static_cast&lt;</span>tk::real<span class="keyword">&gt;</span>(bin / n) + uext[4] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>
                &lt;&lt; p
                &lt;&lt; std::endl;
      ++bin;
    }
  }

  <a class="code" href="_exception_8h.html#ac75cd6578896829d2bfbccf5de71de4f" title="ErrChk macro that only throws an exception if expr fails.">ErrChk</a>( !<a class="code" href="classtk_1_1_writer.html#ae96bd6d4e680c490f290264a37cd1213" title="File output stream.">m_outFile</a>.bad(), <span class="stringliteral">&quot;Failed to write to file: &quot;</span> + <a class="code" href="classtk_1_1_writer.html#a7a3f5175d78fff6d537d82c8a0a37f0e" title="File name.">m_filename</a> );
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_p_d_f_writer_a9a0572ffefffc20b60111327e220e3a6_cgraph.svg" width="312" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>

<p><a href="classtk_1_1_p_d_f_writer-members.html">List of all members.</a></p>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/jbakosi/quinoa/src/IO/<a class="el" href="_p_d_f_writer_8h_source.html">PDFWriter.h</a></li>
<li>/home/travis/build/jbakosi/quinoa/src/IO/<a class="el" href="_p_d_f_writer_8_c_source.html">PDFWriter.C</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespacetk.html">tk</a>      </li>
      <li class="navelem"><a class="el" href="classtk_1_1_p_d_f_writer.html">PDFWriter</a>      </li>

    <li class="footer">Generated on Tue Jul 7 2015 00:09:50 for Quinoa by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
