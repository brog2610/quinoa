SET(libaec_SRCS encode.c encode_accessors.c decode.c)
ADD_LIBRARY(aec ${LIB_TYPE} ${libaec_SRCS})
SET_TARGET_PROPERTIES(aec PROPERTIES
  SOVERSION 0.0.3
  )
ADD_LIBRARY(sz ${LIB_TYPE} sz_compat.c)
SET_TARGET_PROPERTIES(sz PROPERTIES
  SOVERSION 2.0.1
  )

TARGET_LINK_LIBRARIES(sz aec)
IF(WIN32 AND BUILD_SHARED_LIBS)
  SET_TARGET_PROPERTIES (aec PROPERTIES DEFINE_SYMBOL "AECDLL_EXPORTS")
  SET_TARGET_PROPERTIES (sz PROPERTIES DEFINE_SYMBOL "AECDLL_EXPORTS")
  SET_TARGET_PROPERTIES(sz PROPERTIES OUTPUT_NAME "szip")
ENDIF(WIN32 AND BUILD_SHARED_LIBS)

ADD_EXECUTABLE(aec_client aec.c)
SET_TARGET_PROPERTIES(aec_client PROPERTIES OUTPUT_NAME "aec")
TARGET_LINK_LIBRARIES(aec_client aec)

IF(UNIX)
  ADD_EXECUTABLE(utime EXCLUDE_FROM_ALL utime.c)
ENDIF(UNIX)

INSTALL(FILES libaec.h szlib.h DESTINATION include)
IF(WIN32)
  INSTALL(TARGETS aec sz
    RUNTIME
    DESTINATION bin
    ARCHIVE
    DESTINATION lib
    COMPONENT libraries
    )
ELSE(WIN32)
  INSTALL(TARGETS aec sz
    LIBRARY
    DESTINATION lib
    ARCHIVE
    DESTINATION lib
    COMPONENT libraries
    )
ENDIF(WIN32)
INSTALL(TARGETS aec_client
  RUNTIME
  DESTINATION bin
  COMPONENT applications
  )
INSTALL(FILES libaec.h szlib.h
  DESTINATION include
  COMPONENT headers
  )
SET(CPACK_COMPONENTS_ALL applications libraries headers)
